import{d as e,r as a,o as t,aN as l,K as s,i as o,j as r,w as c,k as i,n,bi as p,D as u,G as x,P as d,Q as m,R as f,m as _,ab as v,ac as b,a6 as g,I as h,x as y,q as j,t as k,H as w,y as F,h as C}from"./index-b892d4e0.js";import{_ as S}from"./u-popup.01e03503.js";import{_ as M}from"./u-icon.2852c2d9.js";import{_ as z}from"./u--image.b7971bb1.js";import{_ as I}from"./tabbar.3890e971.js";import{a as U,b as D}from"./goods.9f0d57f9.js";import{u as T,M as N}from"./useMescroll.7bd73685.js";import{M as R}from"./mescroll-empty.7dc6de81.js";import{u as V}from"./useShare.30886a29.js";import{_ as q}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-transition.7137dcba.js";import"./u-safe-bottom.f8131532.js";import"./u-image.4f60c619.js";import"./u-badge.9b3b2160.js";import"./u-tabbar.7727a8c8.js";/* empty css                                                                       */import"./wechat.06bcef40.js";const A=q(e({__name:"list",setup(e){const{mescrollInit:q,downCallback:A,getMescroll:E}=T(b,v),{setShare:B,onShareAppMessage:G,onShareTimeline:H}=V();B(),G(),H();let K=a([]),P=a([]),Q=a(""),J=a(""),L=a(null),O=a(!1),W=a(!1),X=a(""),Y=a("asc"),Z=a("asc"),$=a("all"),ee=a(!0);t((async e=>{J.value=e.curr_goods_category||"",X.value=e.goods_name||"",Q.value=e.coupon_id||"",await U().then((e=>{K.value.push({category_name:"全部",category_id:""}),K.value=K.value.concat(e.data)}))}));const ae=e=>{O.value=!1;let a={goods_category:J.value,page:e.num,limit:e.size,keyword:X.value,coupon_id:Q.value,order:"all"===$.value?"":$.value,sort:"price"==$.value?Y.value:Z.value};D(a).then((a=>{let t=a.data.data;1===Number(e.num)&&(P.value=[]),P.value=P.value.concat(t),e.endSuccess(t.length),O.value=!0})).catch((()=>{O.value=!0,e.endErr()}))},te=e=>{e==$.value&&"price"==e&&(Z.value="asc",Y.value="asc"==Y.value?"desc":"asc"),e==$.value&&"sale_num"==e&&(Y.value="asc",Z.value="asc"==Z.value?"desc":"asc"),$.value=e,"label"==e?(Z.value="asc",Y.value="asc",W.value=!0):(W.value=!1,P.value=[],E().resetUpScroll())},le=()=>{ee.value=!ee.value},se=e=>{C({url:"/addon/shop/pages/goods/detail",param:{goods_id:e},mode:"navigateTo"})};return l((()=>{setTimeout((()=>{E().optUp.textNoMore=s("end")}),500)})),(e,a)=>{const t=g,l=h,s=y,v=j(k("u-popup"),S),b=j(k("u-icon"),M),C=j(k("u--image"),z),U=j(k("tabbar"),I);return o(),r(s,{class:"bg-gray-100 min-h-[100vh]"},{default:c((()=>[i(s,{class:"fixed left-0 right-0 top-0 product-warp bg-[#fff] px-[24rpx]"},{default:c((()=>[i(s,{class:"flex items-center h-[106rpx] box-border py-[24rpx]"},{default:c((()=>[i(s,{class:"bg-[#F5F5F5] flex items-center justify-between h-[66rpx] rounded-[33rpx] flex-1 pl-[20rpx] mr-[40rpx]"},{default:c((()=>[i(t,{class:"uni-input text-sm flex-1",maxlength:"50",modelValue:n(X),"onUpdate:modelValue":a[0]||(a[0]=e=>p(X)?X.value=e:X=e),onConfirm:a[1]||(a[1]=e=>te("all")),placeholder:"请搜索您想要的商品"},null,8,["modelValue"]),i(l,{class:"iconfont iconxiazai17 text-[30rpx] mr-[18rpx]",onClick:a[2]||(a[2]=e=>te("all"))})])),_:1}),i(l,{class:u(["iconfont text-[44rpx]",n(ee)?"iconshangpinliebiao":"iconliebiaoxingshi"]),onClick:le},null,8,["class"])])),_:1}),i(s,{class:"pb-3 pt-1 flex items-center justify-between"},{default:c((()=>[i(l,{class:u(["text-sm",{"text-color":"all"==n($)}]),onClick:a[3]||(a[3]=e=>te("all"))},{default:c((()=>[x("综合")])),_:1},8,["class"]),i(s,{class:u(["flex items-center",[{"text-color":"sale_num"==n($)}]]),onClick:a[4]||(a[4]=e=>te("sale_num"))},{default:c((()=>[i(l,{class:"text-sm mr-[4rpx]"},{default:c((()=>[x("销量")])),_:1}),"asc"==n(Z)?(o(),r(l,{key:0,class:"text-xs iconfont iconjiantoushang font-bold"})):(o(),r(l,{key:1,class:"text-xs iconfont iconxialajiantouxiao"}))])),_:1},8,["class"]),i(s,{class:u(["flex items-center",[{"text-color":"price"==n($)}]]),onClick:a[5]||(a[5]=e=>te("price"))},{default:c((()=>[i(l,{class:"text-sm mr-[4rpx]"},{default:c((()=>[x("价格")])),_:1}),"asc"==n(Y)?(o(),r(l,{key:0,class:"text-xs iconfont iconjiantoushang font-bold"})):(o(),r(l,{key:1,class:"text-xs iconfont iconxialajiantouxiao"}))])),_:1},8,["class"]),i(s,{class:u(["flex items-center",[{"text-color":"label"==n($)}]]),onClick:a[6]||(a[6]=e=>te("label"))},{default:c((()=>[i(l,{class:"text-sm mr-[2rpx]"},{default:c((()=>[x("筛选")])),_:1}),i(l,{class:"iconfont iconshaixuan"})])),_:1},8,["class"])])),_:1})])),_:1}),i(v,{show:n(W),mode:"top",onClose:a[7]||(a[7]=e=>p(W)?W.value=!1:W=!1)},{default:c((()=>[i(s,{class:"text-sm font-bold px-[30rpx] mt-3"},{default:c((()=>[x("全部分类")])),_:1}),i(s,{class:"flex flex-wrap pl-[30rpx] pt-[30rpx]"},{default:c((()=>[(o(!0),d(f,null,m(n(K),((e,a)=>(o(),r(l,{onClick:a=>{return t=e.category_id,J.value=t,P.value=[],E().resetUpScroll(),void(W.value=!1);var t},key:e.category_id,class:u(["px-[26rpx] border-[2rpx] border-solid border-transparent h-[60rpx] mr-[30rpx] mb-[30rpx] flex items-center justify-center bg-[#F4F4F4] rounded-[8rpx] text-xs",{"label-select":n(J)==e.category_id}])},{default:c((()=>[x(w(e.category_name),1)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1},8,["show"]),i(N,{ref_key:"mescrollRef",ref:L,top:"174rpx",bottom:"50px",onInit:n(q),onDown:n(A),onUp:ae},{default:c((()=>[i(s,{class:u(["p-[24rpx] !pb-0",n(ee)?"":"flex justify-between flex-wrap"])},{default:c((()=>[(o(!0),d(f,null,m(n(P),((e,a)=>(o(),d(f,null,[n(ee)?(o(),r(s,{key:0,class:u(["bg-white flex p-[20rpx] rounded-[16rpx]",{"mt-[20rpx]":a}]),onClick:a=>se(e.goods_id)},{default:c((()=>[i(C,{class:"rounded-[10rpx] overflow-hidden",width:"200rpx",height:"200rpx",src:n(F)(e.goods_cover_thumb_mid?e.goods_cover_thumb_mid:""),model:"aspectFill"},{error:c((()=>[i(b,{name:"photo",color:"#999",size:"50"})])),_:2},1032,["src"]),i(s,{class:"flex-1 flex flex-col ml-[20rpx]"},{default:c((()=>[i(s,{class:"text-[26rpx] font-500 h-[80rpx] leading-[40rpx] multi-hidden mb-[10rpx]"},{default:c((()=>[x(w(e.goods_name),1)])),_:2},1024),i(s,{class:"mt-auto flex justify-between items-end"},{default:c((()=>[i(s,{class:"flex flex-col"},{default:c((()=>[i(l,{class:"text-[28rpx] text-[var(--price-text-color)] price-font"},{default:c((()=>[x("￥"+w(e.goodsSku.price),1)])),_:2},1024)])),_:2},1024),i(l,{class:"text--[24rpx] text-[#666]"},{default:c((()=>[x("已售"+w(e.sale_num)+w(e.unit),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])):(o(),r(s,{key:1,class:"w-[342rpx] bg-[#fff] box-border rounded-[10rpx] overflow-hidden mt-[20rpx]",onClick:a=>se(e.goods_id)},{default:c((()=>[i(C,{width:"342rpx",height:"342rpx",src:n(F)(e.goods_cover_thumb_mid?e.goods_cover_thumb_mid:""),model:"aspectFill"},{error:c((()=>[i(b,{name:"photo",color:"#999",size:"50"})])),_:2},1032,["src"]),i(s,{class:"pl-[22rpx] pr-[30rpx] mt-[18rpx] h-[80rpx] leading-[40rpx] text-[26rpx] font-500 multi-hidden"},{default:c((()=>[x(w(e.goods_name),1)])),_:2},1024),i(s,{class:"pl-[22rpx] pb-[20rpx] pr-[30rpx] flex justify-between items-end mt-[12rpx]"},{default:c((()=>[i(s,{class:"flex justify-between items-end"},{default:c((()=>[i(l,{class:"text-[28rpx] text-[var(--price-text-color)] price-font"},{default:c((()=>[x("￥"+w(e.goodsSku.price),1)])),_:2},1024),_(' <text class="text-[28rpx] font-bold text-[#FF3223]"\r\n\t\t\t\t\t\t\t\t\tv-if="!parseFloat(item.price) && parseFloat(item.balance)">{{item.balance}}牛币</text>\r\n\t\t\t\t\t\t\t\t<text class="text-[24rpx] ml-[6rpx]"\r\n\t\t\t\t\t\t\t\t\tv-if="parseFloat(item.price) && parseFloat(item.balance) || !parseFloat(item.price) && !parseFloat(item.balance)">{{item.balance}}牛币</text> ')])),_:2},1024),i(l,{class:"text--[24rpx] text-[#666] leading-[31rpx]"},{default:c((()=>[x("已售"+w(e.sale_num)+w(e.unit),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"]))],64)))),256))])),_:1},8,["class"]),!n(P).length&&n(O)?(o(),r(R,{key:0})):_("v-if",!0)])),_:1},8,["onInit","onDown"]),i(U,{addon:"shop"})])),_:1})}}}),[["__scopeId","data-v-7594b2d6"]]);export{A as default};
