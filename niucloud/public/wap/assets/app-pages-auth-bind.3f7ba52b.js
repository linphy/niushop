import{d as e,l as a,k as l,r as o,p as r,H as t,t as s,o as i,c as n,w as p,b as d,x as u,y as m,u as c,s as b,f as g,n as x,B as f,S as _,a as h,D as y,j as v,g as k,i as j,E as S,F as C,O as T,m as V}from"./index-4dda66b6.js";import{_ as w}from"./u-input.52123ca7.js";import{_ as F,a as P}from"./u-form.a2a3220e.js";import{_ as O}from"./sms-code.vue_vue_type_script_setup_true_lang.fc19aacd.js";import{_ as q,a as z}from"./u-checkbox-group.56070d31.js";import{t as B}from"./topTabbar.8c5d3fa7.js";import{_ as E}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.252ff5e7.js";import"./u-line.89feda2c.js";import"./u-modal.e4391a5a.js";import"./u-loading-icon.10016ae2.js";import"./u-popup.5542352e.js";import"./u-transition.c22f21f6.js";const M=E(e({__name:"bind",setup(e){let E={};B().setTopTabbarParam({title:"",topStatusBar:{bgColor:"#fff",textColor:"#333"}}),a((()=>Object.keys(E).length?T(Number(E.height))+T(E.top)+T(8)+"rpx":"auto"));const M=l(),U=a((()=>M.info)),A=a((()=>V().login)),I=o(!1),D=o(!1),H=r({mobile:"",mobile_code:"",mobile_key:""}),L=o(!0);o(null),t((()=>{setTimeout((()=>{L.value=!1}),800),uni.getStorageSync("openid")&&Object.assign(H,{openid:uni.getStorageSync("openid")}),uni.getStorageSync("pid")&&Object.assign(H,{pid:uni.getStorageSync("pid")}),uni.getStorageSync("unionid")&&Object.assign(H,{unionid:uni.getStorageSync("unionid")})}));const N={mobile:[{type:"string",required:!0,message:s("mobilePlaceholder"),trigger:["blur","change"]},{validator(e,a,l){/^1[3-9]\d{9}$/.test(a)?l():l(new Error("请输入正确的手机号"))},message:s("mobileError"),trigger:["change","blur"]}],mobile_code:{type:"string",required:!0,message:s("codePlaceholder"),trigger:["blur","change"]}},R=()=>{D.value=!D.value},$=o(null),G=()=>{$.value.validate().then((()=>{if(I.value)return;I.value=!0;(U.value?f:_)(H).then((e=>{U.value?(M.getMemberInfo(),h({url:"/app/pages/member/personal",mode:"redirectTo"})):(M.setToken(e.data.token),y().handleLoginBack())})).catch((()=>{I.value=!1}))}))};return(e,a)=>{const l=v,o=k(j("u-input"),w),r=k(j("u-form-item"),F),t=k(j("sms-code"),O),f=k(j("u-form"),P),_=k(j("u-checkbox"),q),y=k(j("u-checkbox-group"),z),T=S,V=C;return i(),n(l,{class:"w-screen h-screen flex flex-col",style:x(e.themeColor())},{default:p((()=>[d(l,{class:"mx-[60rpx]"},{default:p((()=>[d(l,{class:"pt-[140rpx] text-[50rpx] text-[#333]"},{default:p((()=>[u(m(c(s)("bindMobile")),1)])),_:1}),d(l,{class:"text-[26rpx] leading-[39rpx] text-[var(--text-color-light6)] mt-[16rpx] mb-[80rpx]"},{default:p((()=>[u(m(c(s)("bindMobileTip")),1)])),_:1}),d(f,{labelPosition:"left",model:H,errorType:"toast",rules:N,ref_key:"formRef",ref:$},{default:p((()=>[d(l,{class:"h-[90rpx] flex w-full items-center px-[30rpx] rounded-[var(--goods-rounded-mid)] box-border bg-[#F6F6F6]"},{default:p((()=>[d(r,{label:"",prop:"mobile","border-bottom":!1},{default:p((()=>[d(o,{modelValue:H.mobile,"onUpdate:modelValue":a[0]||(a[0]=e=>H.mobile=e),type:"number",maxlength:"11",border:"none",placeholder:c(s)("mobilePlaceholder"),class:"!bg-transparent",disabled:L.value,fontSize:"26rpx",placeholderClass:"!text-[var(--text-color-light9)] text-[26rpx]"},null,8,["modelValue","placeholder","disabled"])])),_:1})])),_:1}),d(l,{class:"h-[90rpx] flex w-full items-center px-[30rpx] rounded-[var(--goods-rounded-mid)] box-border bg-[#F6F6F6] mt-[40rpx]"},{default:p((()=>[d(r,{label:"",prop:"mobile_code","border-bottom":!1},{default:p((()=>[d(o,{modelValue:H.mobile_code,"onUpdate:modelValue":a[2]||(a[2]=e=>H.mobile_code=e),type:"number",maxlength:"4",border:"none",placeholder:c(s)("codePlaceholder"),class:"!bg-transparent",disabled:L.value,fontSize:"26rpx",placeholderClass:"!text-[var(--text-color-light9)]"},{suffix:p((()=>[d(t,{mobile:H.mobile,type:"bind_mobile",modelValue:H.mobile_key,"onUpdate:modelValue":a[1]||(a[1]=e=>H.mobile_key=e)},null,8,["mobile","modelValue"])])),_:1},8,["modelValue","placeholder","disabled"])])),_:1})])),_:1})])),_:1},8,["model"]),d(l,{class:"mt-[100rpx]"},{default:p((()=>[c(A).agreement_show?(i(),n(l,{key:0,class:"flex items-center mb-[20rpx] py-[10rpx]",onClick:b(R,["stop"])},{default:p((()=>[d(y,{onChange:R},{default:p((()=>[d(_,{activeColor:"var(--primary-color)",checked:D.value,shape:"circle",size:"24rpx",customStyle:{marginTop:"4rpx"}},null,8,["checked"])])),_:1}),d(l,{class:"text-[24rpx] text-[var(--text-color-light6)] flex items-center flex-wrap"},{default:p((()=>[d(T,null,{default:p((()=>[u(m(c(s)("agreeTips")),1)])),_:1}),d(T,{onClick:a[3]||(a[3]=b((e=>c(h)({url:"/app/pages/auth/agreement?key=privacy"})),["stop"])),class:"text-primary"},{default:p((()=>[u("《"+m(c(s)("privacyAgreement"))+"》",1)])),_:1}),d(T,null,{default:p((()=>[u(m(c(s)("and")),1)])),_:1}),d(T,{onClick:a[4]||(a[4]=b((e=>c(h)({url:"/app/pages/auth/agreement?key=service"})),["stop"])),class:"text-primary"},{default:p((()=>[u("《"+m(c(s)("userAgreement"))+"》",1)])),_:1})])),_:1})])),_:1},8,["onClick"])):g("v-if",!0),d(V,{class:"w-full h-[80rpx] !bg-[var(--primary-color)] text-[26rpx] rounded-[40rpx] leading-[80rpx] font-500 !text-[#fff]",onClick:G},{default:p((()=>[u(m(c(s)("bind")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["style"])}}}),[["__scopeId","data-v-3598674c"]]);export{M as default};
