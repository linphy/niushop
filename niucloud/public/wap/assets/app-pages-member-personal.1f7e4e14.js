import{d as e,k as a,l,r as t,H as o,p as n,u as r,o as s,c as i,w as u,b as d,x as p,y as m,f as c,s as f,n as x,A as v,t as h,bM as y,bk as b,g as _,i as k,j as g,F as w,I as j,N as C,bN as z,a as S}from"./index-7c3a221b.js";import{_ as V}from"./u-avatar.3386fbb9.js";import{_ as D}from"./u-upload.e2017f75.js";import{_ as I,a as A,b as $}from"./u-action-sheet.b185a90c.js";import{_ as B}from"./u-popup.9cffd7ac.js";import{_ as N}from"./u-datetime-picker.e7bc9307.js";import{_ as O}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.55521b35.js";import"./u-loading-icon.2d721490.js";import"./u-line.10b7be7f.js";import"./u-transition.2636624c.js";import"./u-input.9b5ee2af.js";const P=O(e({__name:"personal",setup(e){const O=a(),P=l((()=>O.info));t(null),o((()=>{}));const M=n({modal:!1,value:P.nickname||""}),U=e=>{M.value=e.detail.value},q=()=>{uni.$u.test.isEmpty(M.value)?v({title:h("nicknamePlaceholder"),icon:"none"}):y({field:"nickname",value:M.value}).then((e=>{O.info.nickname=M.value,M.modal=!1}))},E=t(!1),F=l((()=>[{name:h("man"),value:1},{name:h("woman"),value:2}])),H=e=>{y({field:"sex",value:e.value}).then((a=>{O.info.sex_name=e.name}))},R=e=>{b({filePath:e.file.url,name:"file"}).then((e=>{y({field:"headimg",value:e.data.url}).then((()=>{O.info.headimg=e.data.url}))})).catch((()=>{}))},T=t(!1),G=e=>{y({field:"birthday",value:uni.$u.date(e.value,"yyyy-mm-dd")}).then((()=>{O.info.birthday=uni.$u.date(e.value||e.value+1,"yyyy-mm-dd"),T.value=!1}))};return(e,a)=>{const l=_(k("u-avatar"),V),t=_(k("u-upload"),D),o=_(k("u-cell"),I),n=g,v=w,y=_(k("u-cell-group"),A),b=j,O=_(k("u-popup"),B),J=_(k("u-action-sheet"),$),K=_(k("u-datetime-picker"),N);return r(P)?(s(),i(n,{key:0,class:"w-full h-screen bg-page personal-wrap overflow-hidden",style:x(e.themeColor())},{default:u((()=>[d(n,{class:"my-[var(--top-m)] sidebar-margin overflow-hidden card-template py-[20rpx]"},{default:u((()=>[d(y,{border:!1,class:"cell-group"},{default:u((()=>{return[d(o,{title:r(h)("headimg"),titleStyle:{"font-size":"28rpx"},"is-link":!0},{value:u((()=>[d(t,{onAfterRead:R,maxCount:1},{default:u((()=>[d(l,{src:r(C)(r(P).headimg),"default-url":r(C)("static/resource/images/default_headimg.png"),size:"40",leftIcon:"none"},null,8,["src","default-url"])])),_:1})])),_:1},8,["title"]),d(o,{title:r(h)("nickname"),titleStyle:{"font-size":"28rpx"},"is-link":!0,value:r(P).nickname,onClick:a[0]||(a[0]=e=>M.modal=!0)},null,8,["title","value"]),d(o,{title:r(h)("sex"),titleStyle:{"font-size":"28rpx"},"is-link":!0,value:r(P).sex_name||r(h)("unknown"),onClick:a[1]||(a[1]=e=>E.value=!0)},null,8,["title","value"]),d(o,{title:r(h)("mobile"),titleStyle:{"font-size":"28rpx"}},{value:u((()=>[r(P).mobile?(s(),i(n,{key:0,class:"mr-[10rpx]"},{default:u((()=>[p(m(r(z)(r(P).mobile)),1)])),_:1})):(s(),i(n,{key:1},{default:u((()=>[d(v,{onClick:a[2]||(a[2]=e=>r(S)({url:"/app/pages/auth/bind"})),class:"bg-transparent w-[170rpx] p-[0] rounded-[100rpx] text-[var(--primary-color)] !border-[2rpx] !border-solid border-[var(--primary-color)] text-[24rpx] h-[54rpx] flex-center"},{default:u((()=>[p(m(r(h)("bindMobile")),1)])),_:1})])),_:1}))])),_:1},8,["title"]),d(o,{title:r(h)("birthday"),titleStyle:{"font-size":"28rpx"},"is-link":!0,value:(e=r(P).birthday,(e?uni.$u.date(new Date(e),"yyyy-mm-dd"):"")||r(h)("unknown")),onClick:a[3]||(a[3]=e=>T.value=!0)},null,8,["title","value"])];var e})),_:1})])),_:1}),c(" 修改昵称 "),d(O,{class:"popup-type",safeAreaInsetBottom:!1,round:"var(--rounded-big)",show:M.modal,mode:"center",onClose:a[6]||(a[6]=e=>M.modal=!1)},{default:u((()=>[d(n,{class:"w-[620rpx] popup-common pb-[40rpx]",onTouchmove:a[5]||(a[5]=f((()=>{}),["prevent","stop"]))},{default:u((()=>[d(n,{class:"title !pt-[50rpx] !pb-[60rpx]"},{default:u((()=>[p(m(r(h)("updateNickname")),1)])),_:1}),d(n,{class:"mx-[50rpx] border-0 border-b border-[#eee] border-solid"},{default:u((()=>[d(b,{type:"nickname",class:"h-[88rpx] text-[26rpx]",modelValue:M.value,"onUpdate:modelValue":a[4]||(a[4]=e=>M.value=e),placeholder:r(h)("nicknamePlaceholder"),placeholderClass:"text-[26rpx] h-[88rpx] flex items-center",onBlur:U},null,8,["modelValue","placeholder"])])),_:1}),d(n,{class:"px-[60rpx] pt-[70rpx]"},{default:u((()=>[d(v,{"hover-class":"none",class:"primary-btn-bg text-[#fff] h-[80rpx] font-500 leading-[80rpx] rounded-[100rpx] text-[26rpx]",onClick:q},{default:u((()=>[p(m(r(h)("confirm")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["show"]),c(" 修改性别 "),d(J,{class:"",actions:r(F),show:E.value,closeOnClickOverlay:!0,safeAreaInsetBottom:!0,onClose:a[7]||(a[7]=e=>E.value=!1),onSelect:H},null,8,["actions","show"]),c(" 修改生日 "),d(K,{modelValue:r(P).birthday,"onUpdate:modelValue":a[8]||(a[8]=e=>r(P).birthday=e),show:T.value,mode:"date","confirm-text":r(h)("confirm"),maxDate:(new Date).valueOf(),minDate:0,"cancel-text":r(h)("cancel"),onCancel:a[9]||(a[9]=e=>T.value=!1),onConfirm:G},null,8,["modelValue","show","confirm-text","maxDate","cancel-text"])])),_:1},8,["style"])):c("v-if",!0)}}}),[["__scopeId","data-v-43322988"]]);export{P as default};
