import{d as t,aW as e,m as l,ay as a,j as s,r as o,U as n,a9 as c,O as r,u as i,o as u,c as p,w as y,b as d,n as f,R as x,f as g,y as v,z as m,V as k,as as h,aE as b,bG as _,aN as B,i as w,B as C,D as S,E as V,aF as z,bt as T}from"./index-5b45309d.js";import{m as j}from"./manifest.78a5c925.js";import{_ as I}from"./_plugin-vue_export-helper.1b428a4d.js";const R=I(t({__name:"top-tabbar",props:{data:{type:Object,default:{}},titleColor:{type:String,default:"#606266"},customBack:{type:Function,default:null},scrollBool:{type:[String,Number],default:-1},isBack:{type:Boolean,default:!0}},setup(t,{expose:I}){const R=t;e().platform;const q=l(),F=a(),G=s((()=>R.data)),L=s((()=>{if(R.data&&R.data.topStatusBar)return R.data.topStatusBar})),U=s((()=>{let t="";return R.isBack&&H.value?(t+="padding-left: 30rpx;","style-1"==L.value.style&&(t+="padding-right:80rpx;")):("style-1"==L.value.style&&(t+="padding-right: 30rpx;"),t+="padding-left: 30rpx;"),t})),$=s((()=>{let t="";return t+="font-size: 28rpx;",t+=`color: ${O.value};`,"style-1"==L.value.style&&(t+=`text-align: ${L.value.textAlign};`),t})),O=s((()=>{let t="";return t=1==R.scrollBool?L.value.rollTextColor:L.value.textColor,t})),A=s((()=>{let t="";return t=1==R.scrollBool?L.value.rollBgColor:L.value.bgColor,t}));let E=uni.getStorageSync("componentsScrollValGroup");if(E)E.TopTabbar=0,uni.setStorageSync("componentsScrollValGroup",E);else{let t={TopTabbar:0};uni.setStorageSync("componentsScrollValGroup",t)}const H=o(!1);let N=n();const D=()=>{"function"==typeof R.customBack?R.customBack():k()},P=s((()=>`calc(100vw - ${q.menuButtonInfo.right}px + ${q.menuButtonInfo.width}px + 10px)`)),W=o(0),J=z(),K=o("定位中...");let M=uni.getStorageSync("mapConfig");const Q=()=>{if(Z("latng")){K.value="定位中...";let e=q.location;var t=Z("latng").split(",");e.latitude=t[0],e.longitude=t[1],q.setLocation(e)}K.value="定位中...",uni.getStorageSync("addressByLatlng")&&(K.value=uni.getStorageSync("addressByLatlng").formatted_addresses.recommend),1==M.is_open&&_()&&_().is_expired&&B({fail:t=>{K.value="定位中..."}})};c((()=>q.location),((t,e)=>{t.latitude&&t.longitude?X():K.value="定位中..."}),{deep:!0});const X=()=>{let t={latlng:""};t.latlng=q.location.latitude+","+q.location.longitude,T(t).then((t=>{t.data&&Object.keys(t.data).length?(K.value=t.data.formatted_addresses.recommend,uni.setStorageSync("addressByLatlng",t.data)):K.value="定位中..."}))},Y=()=>{let t=location.origin+location.pathname;window.location.href="https://apis.map.qq.com/tools/locpicker?search=1&type=0&backurl="+encodeURIComponent(t)+"&key="+j.h5.sdkConfigs.maps.qqmap.key+"&referer=myapp"},Z=t=>{for(var e=window.location.search.substring(1).split("&"),l=0;l<e.length;l++){var a=e[l].split("=");if(a[0]==t)return a[1]}return!1};r((()=>{h((()=>{b().in(J).select(".ns-navbar-wrap .u-navbar .content-wrap").boundingClientRect((t=>{W.value=t?t.height:0,F.topTabarHeight=W.value})).exec()})),N.length>1&&(H.value=!0),L.value&&"style-4"==L.value.style&&Q()}));return I({refresh:()=>{L.value&&"style-4"==L.value.style&&Q()}}),(e,l)=>{const a=w,s=C,o=S;return"decorate"!=i(F).mode&&i(L)?(u(),p(a,{key:0,class:x(["ns-navbar-wrap",i(L).style])},{default:y((()=>[d(a,{class:x(["u-navbar",{fixed:-1!=R.scrollBool,absolute:-1==R.scrollBool}]),style:f({backgroundColor:i(A)})},{default:y((()=>[d(a,{class:"navbar-inner",style:f({width:"100%",height:W.value+"px"})},{default:y((()=>["style-1"==i(L).style?(u(),p(a,{key:0,class:x(["content-wrap",[i(L).textAlign]]),style:f(i(U))},{default:y((()=>[t.isBack&&H.value?(u(),p(a,{key:0,class:"back-wrap -ml-[16rpx] text-[27px] nc-iconfont nc-icon-zuoV6xx",style:f({color:i(O)}),onClick:D},null,8,["style"])):g("v-if",!0),d(a,{class:"title-wrap",style:f(i($))},{default:y((()=>[v(m(i(G).title),1)])),_:1},8,["style"])])),_:1},8,["class","style"])):g("v-if",!0),"style-2"==i(L).style?(u(),p(a,{key:1,class:"content-wrap",style:f(i(U)),onClick:l[0]||(l[0]=t=>i(F).toRedirect(i(L).link))},{default:y((()=>[t.isBack&&H.value?(u(),p(a,{key:0,class:"back-wrap -ml-[16rpx] text-[27px] nc-iconfont nc-icon-zuoV6xx",style:f({color:i(O)}),onClick:D},null,8,["style"])):g("v-if",!0),d(a,{class:"title-wrap",style:f({color:i(L).textColor})},{default:y((()=>[d(a,null,{default:y((()=>[d(s,{src:i(V)(i(L).imgUrl),mode:"heightFix"},null,8,["src"])])),_:1}),d(a,{style:f({color:i(L).textColor})},{default:y((()=>[v(m(i(G).title),1)])),_:1},8,["style"])])),_:1},8,["style"])])),_:1},8,["style"])):g("v-if",!0),"style-3"==i(L).style?(u(),p(a,{key:2,style:f(i(U)),class:"content-wrap"},{default:y((()=>[t.isBack&&H.value?(u(),p(a,{key:0,class:"back-wrap -ml-[16rpx] text-[27px] nc-iconfont nc-icon-zuoV6xx",style:f({color:i(O)}),onClick:D},null,8,["style"])):g("v-if",!0),d(a,{class:"title-wrap",onClick:l[1]||(l[1]=t=>i(F).toRedirect(i(L).link))},{default:y((()=>[d(s,{src:i(V)(i(L).imgUrl),mode:"heightFix"},null,8,["src"])])),_:1}),d(a,{class:"search",onClick:l[2]||(l[2]=t=>i(F).toRedirect(i(L).link)),style:f({height:i(q).menuButtonInfo.height-2+"px",lineHeight:i(q).menuButtonInfo.height-2+"px"})},{default:y((()=>[d(o,{class:"nc-iconfont nc-icon-sousuo-duanV6xx1 text-[24rpx] absolute left-[20rpx]"}),d(o,{class:"text-[24rpx]"},{default:y((()=>[v(m(i(L).inputPlaceholder),1)])),_:1})])),_:1},8,["style"]),d(a,{style:f({width:i(P)})},null,8,["style"])])),_:1},8,["style"])):g("v-if",!0),"style-4"==i(L).style?(u(),p(a,{key:3,style:f(i(U)),class:"content-wrap"},{default:y((()=>[t.isBack&&H.value?(u(),p(a,{key:0,class:"back-wrap -ml-[16rpx] text-[27px] nc-iconfont nc-icon-zuoV6xx",style:f({color:i(O)}),onClick:D},null,8,["style"])):g("v-if",!0),d(o,{class:"nc-iconfont nc-icon-dizhiguanliV6xx text-[28rpx]",style:f({color:i(L).textColor})},null,8,["style"]),d(a,{class:"title-wrap",onClick:l[3]||(l[3]=t=>Y()),style:f({color:i(L).textColor})},{default:y((()=>[v(m(K.value),1)])),_:1},8,["style"]),d(o,{class:"nc-iconfont nc-icon-youV6xx text-[26rpx]",onClick:l[4]||(l[4]=t=>Y()),style:f({color:i(L).textColor})},null,8,["style"])])),_:1},8,["style"])):g("v-if",!0)])),_:1},8,["style"])])),_:1},8,["class","style"]),g(" 解决fixed定位后导航栏塌陷的问题 "),d(a,{class:"u-navbar-placeholder",style:f({width:"100%",paddingTop:W.value+"px"})},null,8,["style"])])),_:1},8,["class"])):g("v-if",!0)}}}),[["__scopeId","data-v-51d5379b"]]);export{R as _};
