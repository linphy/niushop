import{d as G,r as x,l as H,M as K,h,m as k,w as r,a as u,e as i,i as w,u as C,aK as L,c as F,F as T,O as R,t as D,Q as _,P as Q,D as z,G as J,H as W,b2 as X,E as Y,V as Z}from"./index-ac08d87d.js";/* empty css                  *//* empty css                   *//* empty css                  *//* empty css                        *//* empty css                 *//* empty css                */import"./el-form-item-4ed993c7.js";import{_ as ee}from"./add-theme.vue_vue_type_script_setup_true_lang-7d7b3e4b.js";import{u as te}from"./diy-9e975008.js";import{e as le,b as ae}from"./diy-bb1bdac0.js";const oe={class:"form-tip"},ne={class:"flex items-center"},se=["onClick"],re=["onClick"],ie={class:"form-tip"},de=u("span",{class:"mr-[3px]"},"+",-1),ue=u("span",null,"新增颜色",-1),me=[de,ue],pe=u("div",{class:"form-tip"},"新增颜色key值不能与当前的存在的key值重复",-1),fe={class:"dialog-footer"},Ee=G({__name:"edit-theme",emits:["confirm"],setup(ce,{expose:U,emit:B}){const V=te(),f=x(!1),g=x(),t=H({title:"",id:"",theme:{},default_theme:{},new_theme:[],key:"",theme_field:[]}),E=x(),I=K(()=>({title:[{required:!0,message:"请输入色调名称",trigger:"blur"}]})),d=x(),j=l=>{Object.keys(t).forEach(e=>{t[e]=l[e]!=null?_(l[e]):""}),d.value=[..._(t.theme_field)],d.value.forEach((e,a)=>{e.value=l.theme[e.label]?l.theme[e.label]:e.value}),f.value=!0},A=()=>{const l=[];d.value.forEach((a,s)=>{l.push(a.label)});const e={key:l};g.value.open(e)},O=l=>{const e=[];d.value.forEach((s,n)=>{e.push(s.label)});const a={key:e,data:l};g.value.open(a)},S=l=>{let e=-1;for(let a=0;a<t.new_theme.length;a++)t.new_theme[a].label==l.label&&(e=a);e>-1&&t.new_theme.splice(e,1)},M=l=>{for(let e=0;e<t.new_theme.length;e++)if(t.new_theme[e].label==l.label){t.new_theme[e]=l;return}t.new_theme.push(l)},N=()=>{t.default_theme&&Object.keys(t.default_theme).length?d.value.forEach((l,e)=>{l.value=t.default_theme[l.label]}):(d.value=_(t.theme_field),t.id||(t.title="")),t.new_theme=[],Q({message:"重置成功",type:"success"})};let v=!1;const P=async l=>{l&&await l.validate(async e=>{if(e){const a={title:"",id:"",theme:{},default_theme:{},new_theme:[],addon:""};a.title=t.title,d.value.forEach((n,m)=>{a.theme[n.label]=n.value}),t.new_theme.forEach((n,m)=>{a.theme[n.label]=n.value}),a.new_theme=t.new_theme||[];let s=null;if(t.id?(s=le,a.id=t.id):s=ae,a.addon=t.key,t.id==""){const n={};t.theme_field.forEach((m,c)=>{n[m.label]=m.value}),a.default_theme=_(n)}else a.default_theme=_(t.default_theme);if(v)return!1;v=!0,s(a).then(n=>{v=!1,f.value=!1,B("confirm",a)}).catch(()=>{v=!1})}})},$=(l,e)=>{const a=/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,s=/^rgba?\((\d+),\s*(\d+),\s*(\d+)(,\s*\d*\.?\d+)?\)$/;if(a.test(l)){const n=l.replace("#",""),m=parseInt(n.substring(0,2),16),c=parseInt(n.substring(2,4),16),y=parseInt(n.substring(4,6),16);return`rgba(${m},${c},${y},${e})`}else if(s.test(l))return l.replace(/[\d\.]+\)$/,`${e})`);return l},q=(l,e)=>{e.label=="--primary-color"&&d.value.forEach((a,s)=>{a.label=="--primary-color-light"&&(a.value=$(e.value,.1)),a.label=="--primary-color-light2"&&(a.value=$(e.value,.8))})};return U({dialogThemeVisible:f,open:j}),(l,e)=>{const a=z,s=J,n=W,m=X,c=Y,y=Z;return h(),k(y,{modelValue:f.value,"onUpdate:modelValue":e[5]||(e[5]=o=>f.value=o),title:"编辑色调",width:"850px","align-center":"","destroy-on-close":"true"},{footer:r(()=>[u("div",fe,[i(c,{onClick:e[2]||(e[2]=o=>f.value=!1)},{default:r(()=>[w("取消")]),_:1}),i(c,{type:"primary",plain:"",onClick:e[3]||(e[3]=o=>N())},{default:r(()=>[w("重置")]),_:1}),i(c,{type:"primary",onClick:e[4]||(e[4]=o=>P(E.value))},{default:r(()=>[w("保存")]),_:1})])]),default:r(()=>[i(n,{model:t,"label-width":"150px",rules:C(I)},{default:r(()=>[i(s,{label:"色调名称",prop:"title"},{default:r(()=>[i(a,{modelValue:t.title,"onUpdate:modelValue":e[0]||(e[0]=o=>t.title=o),placeholder:"请输入色调名称",maxlength:"15",class:"!w-[250px]",disabled:t.id!=""},null,8,["modelValue","disabled"])]),_:1})]),_:1},8,["model","rules"]),i(n,{model:d.value,"label-width":"150px",class:"h-[640px] overflow-auto",ref_key:"formRef",ref:E,onSubmit:e[1]||(e[1]=L(()=>{},["prevent"]))},{default:r(()=>[(h(!0),F(T,null,R(d.value,(o,b)=>(h(),k(s,{label:o.title,key:b,prop:`${b}.value`,rules:[{required:!0,message:`请选择${o.title}色调`,trigger:"blur"}]},{default:r(()=>[i(m,{modelValue:o.value,"onUpdate:modelValue":p=>o.value=p,"show-alpha":"",predefine:C(V).predefineColors,onChange:p=>q(p,o)},null,8,["modelValue","onUpdate:modelValue","predefine","onChange"]),u("div",oe,D(o.tip),1)]),_:2},1032,["label","prop","rules"]))),128)),(h(!0),F(T,null,R(t.new_theme,(o,b)=>(h(),k(s,{label:o.title,key:b},{default:r(()=>[u("div",ne,[i(m,{modelValue:o.value,"onUpdate:modelValue":p=>o.value=p,"show-alpha":"",predefine:C(V).predefineColors},null,8,["modelValue","onUpdate:modelValue","predefine"]),u("span",{class:"text-primary cursor-pointer text-[14px] ml-[20px]",onClick:p=>O(o)},"编辑",8,se),u("span",{class:"text-primary cursor-pointer text-[14px] ml-[8px]",onClick:p=>S(o)},"删除",8,re)]),u("div",ie,D(o.tip),1)]),_:2},1032,["label"]))),128)),i(s,null,{default:r(()=>[u("div",{class:"flex items-center text-primary cursor-pointer text-[14px]",onClick:A},me),pe]),_:1})]),_:1},8,["model"]),i(ee,{ref_key:"addThemeRef",ref:g,onConfirm:M},null,512)]),_:1},8,["modelValue"])}}});export{Ee as _};
