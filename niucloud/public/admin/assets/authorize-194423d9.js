import{d as ee,r as a,M as te,l as N,k as n,N as z,h as r,c as C,m as x,w as s,a as e,u as i,i as p,e as l,t as m,B as E,F as oe,O as se,P as le,Q as ae,R as ne,S as re,E as ie,T as ce,U as de,D as ue,G as pe,K as _e,H as me,V as fe,W as xe,X as he}from"./index-a59af0dd.js";/* empty css                  *//* empty css                   *//* empty css                *//* empty css                */import"./el-form-item-4ed993c7.js";/* empty css                 *//* empty css                  *//* empty css                   *//* empty css                  */import{b as ve}from"./sys-d9b3645a.js";import{g as ge,a as ye,s as we}from"./module-0b7c2dd5.js";import ke from"./index-5394ae25.js";import Ce from"./index-11f1cd45.js";import"./dark-244a839c.js";/* empty css               *//* empty css                     *//* empty css                 */import"./_plugin-vue_export-helper-c27b6911.js";/* empty css                   */const Ve={class:"main-container"},be={class:"flex"},Be={class:"w-[450px] mr-[20px] p-[50px] bg-[var(--el-color-info-light-9)]"},Te={class:"flex items-center justify-between"},Ee=e("span",{class:"text-page-title"},"版本信息",-1),Ie={class:"flex-1 w-0 flex justify-end"},Ae={class:"mt-[30px] flex items-center text-[14px] text-[#797979]"},De=e("span",null,"当前版本",-1),Fe={class:"text-[26px] ml-[15px] mr-[10px] text-[#656668]"},Me={key:0,class:"text-[12px]"},Re={key:1,class:"text-[12px] text-[red]"},Le={class:"flex flex-1 justify-between items-center p-[50px] bg-[var(--el-color-info-light-9)]"},Pe={class:"flex flex-col"},He={class:"flex flex-wrap items-center"},Ue=e("p",{class:"text-page-title mr-[20px]"},"授权信息",-1),je={class:"text-[14px] text-[#666]"},Ne={class:"mt-[46px] ml-[40px] flex flex-wrap"},ze={class:"text-[14px] mr-[84px]"},Se={class:"ml-[12px] text-[12px]"},$e={class:"text-[14px] flex items-center"},qe=e("span",null,"授权码",-1),Ge={class:"ml-[12px] mr-[10px] text-[12px]"},Ke={class:"flex flex-1 flex-wrap justify-end relative"},Oe={class:"px-[18px] py-[8px]"},Qe=e("p",{class:"leading-[32px] text-[14px]"},"您在官方应用市场购买任意一款应用，即可获得授权码。输入正确授权码认证通过后，即可支持在线升级和其它相关服务 ",-1),We={class:"flex justify-end mt-[36px]"},Xe={class:"mt-[20px]"},Je={class:"text-sm mt-[10px] text-info"},Ye={class:"mt-[20px]"},Ze={class:"mt-[10px] text-right"},et=e("div",{class:"text-page-title mb-[20px]"},"历史版本",-1),tt={key:0,class:"mt-[10px] p-[20px] bg-overlay rounded-md timeline-log-wrap whitespace-pre"},ot=["innerHTML"],bt=ee({__name:"authorize",setup(st){const I=a(null),y=a(null),A=a(null),h=a(!1),v=a(!1),V=a([]),D=a(null);ve().then(({data:o})=>{D.value=o}).catch();const F=a(!1),M=()=>{ge().then(({data:o})=>{V.value=o,F.value?(!d.value||d.value&&d.value.version_no==k.value)&&le({message:n("versionTips"),type:"success"}):F.value=!0})};M();const d=te(()=>V.value.length?V.value[0]:null),S=o=>{const t=ae(o);return t.slice(0,t.length/2)+t.slice(t.length/2,t.length-1).replace(/./g,"*")},B=()=>{h.value=!0},_=a({company_name:"",site_address:"",auth_code:""}),b=a(!0),w=a(!1),R=()=>{ye().then(o=>{b.value=!1,o.data.data&&o.data.data.length!=0&&(_.value=o.data.data,h.value=!1)}).catch(()=>{b.value=!1,h.value=!1})};R();const g=N({auth_code:"",auth_secret:""}),L=a(),$=N({auth_code:[{required:!0,message:n("authCodePlaceholder"),trigger:"blur"}],auth_secret:[{required:!0,message:n("authSecretPlaceholder"),trigger:"blur"}]}),q=async o=>{w.value||!o||await o.validate(async t=>{t&&(w.value=!0,we(g).then(()=>{w.value=!1,R()}).catch(()=>{w.value=!1,h.value=!1}))})},P=()=>{var o;window.open((o=D.value)==null?void 0:o.website_url)},k=a("");(()=>{ne().then(o=>{k.value=o.data.version.version})})();const G=()=>{var o;if(!_.value.auth_code){B();return}(o=I.value)==null||o.open()},K=()=>{var o;if(!_.value.auth_code){B();return}if(y.value.cloudBuildTask){(o=y.value)==null||o.open();return}re.confirm(n("cloudBuildTips"),n("warning"),{confirmButtonText:n("confirm"),cancelButtonText:n("cancel"),type:"warning"}).then(()=>{var t;(t=y.value)==null||t.open()})};return(o,t)=>{const u=ie,O=z("View"),H=ce,Q=z("Hide"),W=de,U=ue,j=pe,T=_e,X=me,J=fe,Y=xe,Z=he;return r(),C("div",Ve,[b.value?E("",!0):(r(),x(T,{key:0,class:"box-card !border-none",shadow:"never"},{default:s(()=>{var f;return[e("div",be,[e("div",Be,[e("div",Te,[Ee,e("div",Ie,[!i(d)||i(d)&&i(d).version_no==k.value?(r(),x(u,{key:0,class:"text-[#4C4C4C] w-[78px] h-[32px] !bg-transparent",onClick:M},{default:s(()=>[p("检测更新")]),_:1})):(r(),x(u,{key:1,class:"text-[#4C4C4C] w-[78px] h-[32px]",type:"primary",onClick:G},{default:s(()=>[p("一键升级")]),_:1})),l(u,{class:"text-[#4C4C4C] w-[78px] h-[32px]",type:"primary",onClick:K,loading:(f=y.value)==null?void 0:f.loading},{default:s(()=>[p("云编译")]),_:1},8,["loading"])])]),e("div",Ae,[De,e("span",Fe,m(k.value),1),!i(d)||i(d)&&i(d).version_no==k.value?(r(),C("em",Me,"(当前已是最新版本)")):(r(),C("em",Re,"(最新版本"+m(i(d).version_no)+")",1))])]),e("div",Le,[e("div",Pe,[e("div",He,[Ue,e("span",je,m(_.value.company_name||"--"),1)]),e("div",Ne,[e("span",ze,[p("授权域名"),e("em",Se,m(_.value.site_address||"--"),1)]),e("span",$e,[qe,e("em",Ge,m(_.value.auth_code?v.value?_.value.auth_code:S(_.value.auth_code):"--"),1),v.value?(r(),x(H,{key:1,onClick:t[1]||(t[1]=c=>v.value=!v.value),class:"text-[12px] cursor-pointer"},{default:s(()=>[l(Q)]),_:1})):(r(),x(H,{key:0,onClick:t[0]||(t[0]=c=>v.value=!v.value),class:"text-[12px] cursor-pointer"},{default:s(()=>[l(O)]),_:1}))])])]),e("div",Ke,[l(u,{class:"w-[154px] !h-[48px] mt-[8px]",type:"primary",onClick:B},{default:s(()=>[p("授权码认证")]),_:1}),l(W,{ref_key:"getAuthCodeDialog",ref:A,placement:"bottom-start",width:478,trigger:"click",class:"mt-[8px]"},{reference:s(()=>[l(u,{class:"w-[154px] !h-[48px] mt-[8px] !text-[var(--el-color-primary)] hover:!text-[var(--el-color-primary)] !bg-transparent",plain:"",type:"primary"},{default:s(()=>[p("如何获取授权码?")]),_:1})]),default:s(()=>[e("div",Oe,[Qe,e("div",We,[l(u,{class:"w-[182px] !h-[48px]",plain:"",onClick:P},{default:s(()=>[p("去应用市场逛逛")]),_:1}),l(u,{class:"w-[100px] !h-[48px]",plain:"",onClick:t[2]||(t[2]=c=>A.value.hide())},{default:s(()=>[p("关闭")]),_:1})])])]),_:1},512)]),l(J,{modelValue:h.value,"onUpdate:modelValue":t[6]||(t[6]=c=>h.value=c),title:"授权码认证",width:"400px"},{default:s(()=>[l(X,{model:g,"label-width":"0",ref_key:"formRef",ref:L,rules:$,class:"page-form"},{default:s(()=>[l(T,{class:"box-card !border-none",shadow:"never"},{default:s(()=>[l(j,{prop:"auth_code"},{default:s(()=>[l(U,{modelValue:g.auth_code,"onUpdate:modelValue":t[3]||(t[3]=c=>g.auth_code=c),modelModifiers:{trim:!0},placeholder:i(n)("authCodePlaceholder"),class:"input-width",clearable:"",size:"large"},null,8,["modelValue","placeholder"])]),_:1}),e("div",Xe,[l(j,{prop:"auth_secret"},{default:s(()=>[l(U,{modelValue:g.auth_secret,"onUpdate:modelValue":t[4]||(t[4]=c=>g.auth_secret=c),modelModifiers:{trim:!0},clearable:"",placeholder:i(n)("authSecretPlaceholder"),class:"input-width",size:"large"},null,8,["modelValue","placeholder"])]),_:1})]),e("div",Je,m(i(n)("authInfoTips")),1),e("div",Ye,[l(u,{type:"primary",class:"w-full",size:"large",loading:w.value,onClick:t[5]||(t[5]=c=>q(L.value))},{default:s(()=>[p(m(i(n)("confirm")),1)]),_:1},8,["loading"])]),e("div",Ze,[l(u,{type:"primary",link:"",onClick:P},{default:s(()=>[p(m(i(n)("notHaveAuth")),1)]),_:1})])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])])]}),_:1})),b.value?E("",!0):(r(),x(T,{key:1,class:"box-card !border-none",shadow:"never"},{default:s(()=>[et,l(Z,null,{default:s(()=>[(r(!0),C(oe,null,se(V.value,(f,c)=>(r(),x(Y,{timestamp:f.release_time+" 版本："+f.version_no,type:"primary",hollow:!0,placement:"top",key:c},{default:s(()=>[f.upgrade_log?(r(),C("div",tt,[e("div",{innerHTML:f.upgrade_log},null,8,ot)])):E("",!0)]),_:2},1032,["timestamp"]))),128))]),_:1})]),_:1})),l(ke,{ref_key:"upgradeRef",ref:I},null,512),l(Ce,{ref_key:"cloudBuildRef",ref:y},null,512)])}}});export{bt as default};
