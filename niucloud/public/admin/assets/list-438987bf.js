import{d as Ie,v as Me,f as Oe,r as p,l as F,M as te,k as l,bd as Ne,h as c,c as R,e as t,w as o,a as f,t as m,u as r,i as u,F as le,O as ae,m as g,J as je,B as E,n as Le,z as qe,be as Ye,S as O,P as Je,E as We,D as Ae,G as Ge,_ as He,ac as Ke,H as Qe,K as Xe,aj as Ze,$ as et,a6 as tt,aO as lt,aP as at,aQ as ot,a0 as nt,a1 as rt,V as st,a7 as it,a8 as mt,L as ut}from"./index-ac08d87d.js";/* empty css                   */import{_ as pt}from"./index.vue_vue_type_script_setup_true_lang-b0e5dc24.js";import dt from"./index-7d504251.js";/* empty css                    *//* empty css                  *//* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                  *//* empty css                         *//* empty css                        *//* empty css                *//* empty css                */import"./el-form-item-4ed993c7.js";import{l as ct,a as ft,m as _t,n as vt,o as oe,p as yt}from"./diy_form-80c117d7.js";import{_ as gt}from"./records.vue_vue_type_style_index_0_lang-7d024d50.js";import{_ as ht}from"./form-spread-popup.vue_vue_type_script_setup_true_lang-b61fdb8b.js";import{f as bt}from"./form-submit-popup-fbd6df7a.js";import{_ as kt}from"./form-write-popup.vue_vue_type_style_index_0_lang-dc504347.js";import{_ as Ct}from"./_plugin-vue_export-helper-c27b6911.js";import"./sys-5aa982aa.js";/* empty css                        */import"./index.vue_vue_type_style_index_0_lang-8b6f9720.js";import"./attachment-895a7d37.js";import"./index.vue_vue_type_script_setup_true_lang-7df93d15.js";/* empty css                 *//* empty css               *//* empty css                  *//* empty css                    */import"./index.vue_vue_type_script_setup_true_lang-c8b99dcc.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_lang-d1dc26ab.js";import"./sortable.esm-be94e56d.js";/* empty css                  *//* empty css                         *//* empty css                       */import"./member_head-d9fd7b2c.js";import"./browser-a1ac24ac.js";/* empty css                       *//* empty css                 *//* empty css                       */import"./member-2ca9b544.js";const wt={class:"main-container"},xt={class:"flex justify-between items-center"},Dt={class:"text-page-title"},Ft={class:"mb-[10px] flex items-center"},Vt={class:"flex items-center justify-end"},Pt={class:"mt-[16px] flex justify-end"},Tt={class:"image-selection-container"},Et=["onClick"],St=["src"],$t={class:"option-title"},Rt={class:"dialog-footer"},Bt={class:"dialog-footer"},Ut=Ie({__name:"list",setup(zt){const ne=Me(),N=Oe(),re=ne.meta.title,h=p(!1),C=F({}),k=F({title:"",type:""}),B=p(null),se=n=>{let e={form_id:n.form_id};B.value.setFormData(e),B.value.showDialog=!0},ie=te(()=>({title:[{required:!0,message:l("titlePlaceholder"),trigger:"blur"}],type:[{required:!0,message:l("formTypePlaceholder"),trigger:"blur"}]})),j=p(),V=p(!1),me=async n=>{n&&await n.validate(async e=>{if(e){const i={type:k.type},x=N.resolve({path:"/decorate/form/edit",query:i});window.open(x.href),V.value=!1,k.title="",k.type=""}})},L=n=>{const e=n.status===1?0:1,i={form_id:n.form_id,status:e};ct(i).then(x=>{n.status=e})};((n="")=>{ft().then(e=>{for(let i in C)delete C[i];for(const i in e.data)C[i]=e.data[i];k.type=Object.keys(C)[0]})})(),F({});const s=F({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{title:"",type:"",mode:"",addon_name:""}}),q=p(),_=(n=1)=>{s.loading=!0,s.page=n,_t({page:s.page,limit:s.limit,...s.searchParam}).then(e=>{s.loading=!1,s.data=e.data.data,s.total=e.data.total,Ye(s.page,s.limit,s.searchParam)}).catch(()=>{s.loading=!1})};_(Ne(s.searchParam).page);const ue=n=>{k.type=n.toString()},pe=n=>{n&&(n.resetFields(),_())},de=n=>{const e=N.resolve({path:"/decorate/form/edit",query:{form_id:n.form_id}});window.open(e.href)},ce=n=>{O.confirm(l("diyFormCopyTips"),l("warning"),{confirmButtonText:l("confirm"),cancelButtonText:l("cancel"),type:"warning"}).then(()=>{h.value||(h.value=!0,vt({form_id:n}).then(e=>{e.code==1&&_(),h.value=!1}).catch(()=>{h.value=!1}))})},fe=n=>{O.confirm(l("diyFormDeleteTips"),l("warning"),{confirmButtonText:l("confirm"),cancelButtonText:l("cancel"),type:"warning"}).then(()=>{oe({form_ids:[n]}).then(()=>{_()}).catch(()=>{})})},S=p(),$=p(!1),_e=n=>{$.value=!1,Y.value.toggleAllSelection()},Y=p(),w=p([]),ve=n=>{w.value=n,S.value=!1,w.value.length>0&&w.value.length<s.data.length?$.value=!0:$.value=!1,w.value.length==s.data.length&&(S.value=!0)},ye=()=>{if(w.value.length==0){Je({type:"warning",message:`${l("batchEmptySelectedFormsTips")}`});return}O.confirm(l("batchFormsDeleteTips"),l("warning"),{confirmButtonText:l("confirm"),cancelButtonText:l("cancel"),type:"warning"}).then(()=>{if(h.value)return;h.value=!0;const n=[];w.value.forEach(e=>{n.push(e.form_id)}),oe({form_ids:n}).then(()=>{_(),h.value=!1}).catch(()=>{h.value=!1})})},v=p("wechat"),J=p(""),W=p(0),y=F({wechat:{title:"",desc:"",url:""},weapp:{title:"",url:""}}),P=p(!1),ge=te(()=>({})),A=p(),he=async n=>{W.value=n.form_id,J.value=n.title;const e=n.share;y.wechat=e.wechat,y.weapp=e.weapp,P.value=!0},be=async n=>{n&&await n.validate(async e=>{e&&yt({form_id:W.value,share:JSON.stringify(y)}).then(()=>{_(),P.value=!1}).catch(()=>{})})},G=p(null),ke=n=>{G.value.show(n)},U=p(null),Ce=n=>{U.value.setFormData(n),U.value.showDialog=!0},z=p(null),we=n=>{z.value.setFormData(n),z.value.showDialog=!0},xe=p(null),I=p(!1),De=n=>{I.value=n},H=F({form_id:0}),Fe=n=>{H.form_id=n.form_id,I.value=!0};return(n,e)=>{const i=We,x=Ae,b=Ge,K=He,Ve=Ke,M=Qe,Q=Xe,Pe=Ze,D=et,X=tt,T=lt,Te=at,Ee=ot,Se=nt,$e=rt,Z=st,ee=it,Re=mt,Be=dt,Ue=pt,ze=ut;return c(),R("div",wt,[t(Q,{class:"box-card !border-none",shadow:"never"},{default:o(()=>[f("div",xt,[f("span",Dt,m(r(re)),1),t(i,{type:"primary",class:"w-[100px]",onClick:e[0]||(e[0]=a=>V.value=!0)},{default:o(()=>[u(m(r(l)("addDiyForm")),1)]),_:1})]),t(Q,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:o(()=>[t(M,{inline:!0,model:s.searchParam,ref_key:"searchFormDiyFormRef",ref:q},{default:o(()=>[t(b,{label:r(l)("title"),prop:"title"},{default:o(()=>[t(x,{modelValue:s.searchParam.title,"onUpdate:modelValue":e[1]||(e[1]=a=>s.searchParam.title=a),modelModifiers:{trim:!0},placeholder:r(l)("titlePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(b,{label:r(l)("typeName"),prop:"type"},{default:o(()=>[t(Ve,{modelValue:s.searchParam.type,"onUpdate:modelValue":e[2]||(e[2]=a=>s.searchParam.type=a),placeholder:r(l)("formTypePlaceholder")},{default:o(()=>[t(K,{label:r(l)("all"),value:""},null,8,["label"]),(c(!0),R(le,null,ae(C,(a,d)=>(c(),g(K,{label:a.title,value:d,key:d},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),t(b,null,{default:o(()=>[t(i,{type:"primary",onClick:e[3]||(e[3]=a=>_())},{default:o(()=>[u(m(r(l)("search")),1)]),_:1}),t(i,{onClick:e[4]||(e[4]=a=>pe(q.value))},{default:o(()=>[u(m(r(l)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),f("div",Ft,[t(Pe,{modelValue:S.value,"onUpdate:modelValue":e[5]||(e[5]=a=>S.value=a),size:"large",class:"px-[14px]",onChange:_e,indeterminate:$.value},null,8,["modelValue","indeterminate"]),t(i,{onClick:ye,size:"small"},{default:o(()=>[u(m(r(l)("batchDeletion")),1)]),_:1})]),je((c(),g(Se,{data:s.data,size:"large",ref_key:"diyFormListTableRef",ref:Y,onSelectionChange:ve},{empty:o(()=>[f("span",null,m(s.loading?"":r(l)("emptyData")),1)]),default:o(()=>[t(D,{type:"selection",width:"55"}),t(D,{prop:"page_title",label:r(l)("title"),"min-width":"120"},null,8,["label"]),t(D,{prop:"type_name",label:r(l)("typeName"),"min-width":"80"},null,8,["label"]),t(D,{label:r(l)("status"),"min-width":"80"},{default:o(({row:a})=>[a.status==1?(c(),g(X,{key:0,type:"success",class:"cursor-pointer",onClick:d=>L(a)},{default:o(()=>[u(m(r(l)("statusOn")),1)]),_:2},1032,["onClick"])):(c(),g(X,{key:1,type:"info",class:"cursor-pointer",onClick:d=>L(a)},{default:o(()=>[u(m(r(l)("statusOff")),1)]),_:2},1032,["onClick"]))]),_:1},8,["label"]),t(D,{prop:"update_time",label:r(l)("updateTime"),"min-width":"120"},null,8,["label"]),t(D,{label:r(l)("operation"),fixed:"right",align:"right","min-width":"100"},{default:o(({row:a})=>[f("div",Vt,[a.status==1&&a.type=="DIY_FORM"?(c(),g(i,{key:0,type:"primary",link:"",onClick:d=>ke(a)},{default:o(()=>[u(m(r(l)("promotion")),1)]),_:2},1032,["onClick"])):E("",!0),t(i,{type:"primary",link:"",onClick:d=>de(a)},{default:o(()=>[u(m(r(l)("edit")),1)]),_:2},1032,["onClick"]),a.status==0?(c(),g(i,{key:1,type:"primary",link:"",onClick:d=>fe(a.form_id)},{default:o(()=>[u(m(r(l)("delete")),1)]),_:2},1032,["onClick"])):E("",!0),t(i,{type:"primary",link:"",onClick:d=>se(a)},{default:o(()=>[u(m(r(l)("detail")),1)]),_:2},1032,["onClick"]),t(Ee,{placement:"bottom",trigger:"click",class:"ml-[12px]"},{dropdown:o(()=>[t(Te,null,{default:o(()=>[a.type=="DIY_FORM"?(c(),g(T,{key:0},{default:o(()=>[t(i,{type:"primary",class:"w-full",link:"",onClick:d=>Ce(a)},{default:o(()=>[u(m(r(l)("submitSuccess")),1)]),_:2},1032,["onClick"])]),_:2},1024)):E("",!0),t(T,null,{default:o(()=>[t(i,{type:"primary",class:"w-full",link:"",onClick:d=>we(a)},{default:o(()=>[u(m(r(l)("writeSet")),1)]),_:2},1032,["onClick"])]),_:2},1024),a.type=="DIY_FORM"?(c(),g(T,{key:1},{default:o(()=>[t(i,{type:"primary",class:"w-full",link:"",onClick:d=>he(a)},{default:o(()=>[u(m(r(l)("shareSet")),1)]),_:2},1032,["onClick"])]),_:2},1024)):E("",!0),t(T,null,{default:o(()=>[t(i,{type:"primary",class:"w-full",link:"",onClick:d=>Fe(a)},{default:o(()=>[u(m(r(l)("export")),1)]),_:2},1032,["onClick"])]),_:2},1024),t(T,null,{default:o(()=>[t(i,{type:"primary",class:"w-full",link:"",onClick:d=>ce(a.form_id)},{default:o(()=>[u(m(r(l)("copy")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),default:o(()=>[t(i,{type:"primary",link:""},{default:o(()=>[u(m(r(l)("more")),1)]),_:1})]),_:2},1024)])]),_:1},8,["label"])]),_:1},8,["data"])),[[ze,s.loading]]),f("div",Pt,[t($e,{"current-page":s.page,"onUpdate:current-page":e[6]||(e[6]=a=>s.page=a),"page-size":s.limit,"onUpdate:page-size":e[7]||(e[7]=a=>s.limit=a),layout:"total, sizes, prev, pager, next, jumper",total:s.total,onSizeChange:e[8]||(e[8]=a=>_()),onCurrentChange:_},null,8,["current-page","page-size","total"])])]),_:1}),t(Z,{modelValue:V.value,"onUpdate:modelValue":e[11]||(e[11]=a=>V.value=a),title:r(l)("addFormTips"),width:"980px"},{footer:o(()=>[f("span",Rt,[t(i,{onClick:e[9]||(e[9]=a=>V.value=!1)},{default:o(()=>[u(m(r(l)("cancel")),1)]),_:1}),t(i,{type:"primary",onClick:e[10]||(e[10]=a=>me(j.value))},{default:o(()=>[u(m(r(l)("confirm")),1)]),_:1})])]),default:o(()=>[t(M,{model:k,ref_key:"formRef",ref:j,rules:r(ie)},{default:o(()=>[t(b,{prop:"type"},{default:o(()=>[f("div",Tt,[(c(!0),R(le,null,ae(C,(a,d)=>(c(),R("div",{key:d,class:Le(["image-option",{selected:k.type===d}]),onClick:Mt=>ue(d)},[f("img",{src:r(qe)(a.preview),class:"option-image"},null,8,St),f("div",$t,m(a.title),1)],10,Et))),128))])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),t(Z,{modelValue:P.value,"onUpdate:modelValue":e[18]||(e[18]=a=>P.value=a),title:r(l)("shareSet"),width:"30%"},{footer:o(()=>[f("span",Bt,[t(i,{onClick:e[16]||(e[16]=a=>P.value=!1)},{default:o(()=>[u(m(r(l)("cancel")),1)]),_:1}),t(i,{type:"primary",onClick:e[17]||(e[17]=a=>be(A.value))},{default:o(()=>[u(m(r(l)("confirm")),1)]),_:1})])]),default:o(()=>[t(Re,{modelValue:v.value,"onUpdate:modelValue":e[12]||(e[12]=a=>v.value=a)},{default:o(()=>[t(ee,{label:r(l)("wechat"),name:"wechat"},null,8,["label"]),t(ee,{label:r(l)("weapp"),name:"weapp"},null,8,["label"])]),_:1},8,["modelValue"]),t(M,{model:y[v.value],"label-width":"90px",ref_key:"shareFormRef",ref:A,rules:r(ge)},{default:o(()=>[t(b,{label:r(l)("sharePage")},{default:o(()=>[f("span",null,m(J.value),1)]),_:1},8,["label"]),t(b,{label:r(l)("shareTitle"),prop:"title"},{default:o(()=>[t(x,{modelValue:y[v.value].title,"onUpdate:modelValue":e[13]||(e[13]=a=>y[v.value].title=a),modelModifiers:{trim:!0},placeholder:r(l)("shareTitlePlaceholder"),clearable:"",maxlength:"30","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),v.value=="wechat"?(c(),g(b,{key:0,label:r(l)("shareDesc"),prop:"desc"},{default:o(()=>[t(x,{modelValue:y[v.value].desc,"onUpdate:modelValue":e[14]||(e[14]=a=>y[v.value].desc=a),modelModifiers:{trim:!0},placeholder:r(l)("shareDescPlaceholder"),type:"textarea",rows:"4",clearable:"",maxlength:"100","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):E("",!0),t(b,{label:r(l)("shareImageUrl"),prop:"url"},{default:o(()=>[t(Be,{modelValue:y[v.value].url,"onUpdate:modelValue":e[15]||(e[15]=a=>y[v.value].url=a),limit:1},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),t(ht,{ref_key:"formSpreadPopupRef",ref:G},null,512),t(bt,{ref_key:"formSubmitPopupRef",ref:U,onComplete:_},null,512),t(kt,{ref_key:"formWritePopupRef",ref:z,onComplete:_},null,512),t(gt,{ref_key:"recordsDetailDialog",ref:B},null,512),t(Ue,{ref_key:"exportSureDialog",ref:xe,show:I.value,type:"diy_form_records",searchParam:H,onClose:De},null,8,["show","searchParam"])])}}});const zl=Ct(Ut,[["__scopeId","data-v-1dc71c45"]]);export{zl as default};
