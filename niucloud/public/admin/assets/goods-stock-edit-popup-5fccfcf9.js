import{d as G,n as b,r as O,h as _,c as v,e as c,w as n,a as l,i as y,t as d,u as s,N as e,I as x,R as Z,B as E,y as q,a3 as g,V as z,W as M,E as R,ah as W,aj as A,aa as F,$ as H,p as J,g as K}from"./index-a2233f8b.js";/* empty css                   *//* empty css                   *//* empty css                        *//* empty css                    *//* empty css               */import"./el-tooltip-4ed993c7.js";/* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                 *//* empty css                        */import{_ as N}from"./goods_default-664bb559.js";import{r as Q,q as X}from"./goods-b7f9d4bf.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";const ee=f=>(J("data-v-ac8b6475"),f=f(),K(),f),te={class:"flex items-center mb-[10px]"},oe={class:"min-w-[70px] h-[70px] flex items-center justify-center"},ae=ee(()=>l("div",{class:"image-slot"},[l("img",{class:"w-[70px] h-[70px]",src:N})],-1)),se={key:1,class:"w-[70px] h-[70px]",src:N,fit:"contain"},le={class:"ml-2"},ne=["title"],ie={class:"text-primary text-[12px]"},ce={key:0,class:"batch-operation-sku"},re={class:"dialog-footer"},de=G({__name:"goods-stock-edit-popup",emits:["load"],setup(f,{expose:S,emit:T}){const i=b({}),p=O(!1),a=b({loading:!0,data:[]}),m=b({value:""}),$=()=>{if(m.value.length==0){g({type:"warning",message:`${e("stockPlaceholder")}`});return}if(!w.number.test(m.value)){g({type:"warning",message:`${e("stockTips")}`});return}if(m.value<0){g({type:"warning",message:`${e("stockNotZeroTips")}`});return}a.data.forEach(t=>{t.stock=m.value})},B=()=>{a.loading=!0,X({goods_id:i.goods_id}).then(t=>{a.loading=!1,a.data=t.data}).catch(()=>{a.loading=!1})},C=t=>{Object.assign(i,t),B(),p.value=!0},w={number:/^\d{0,10}$/},I=()=>{let t=!0;for(let o=0;o<a.data.length;o++){let u=a.data[o];if(u.stock.length==0){t=!1,g({type:"warning",message:`${e("stockPlaceholder")}`});break}else if(isNaN(u.stock)||!w.number.test(u.stock)){t=!1,g({type:"warning",message:`${e("stockTips")}`});break}else if(u.stock<0){t=!1,g({type:"warning",message:`${e("stockNotZeroTips")}`});break}}return t},D=()=>{if(I()){const t=[];a.data.forEach(o=>{t.push({sku_id:o.sku_id,stock:o.stock})}),Q({goods_id:i.goods_id,sku_list:t}).then(o=>{T("load"),p.value=!1})}};return S({showDialog:p,show:C}),(t,o)=>{const u=z,V=M,h=R,k=W,P=A,L=F,U=H;return _(),v("div",null,[c(L,{modelValue:p.value,"onUpdate:modelValue":o[2]||(o[2]=r=>p.value=r),title:s(e)("editStockPopupTitle"),width:"600px","close-on-press-escape":!1,"destroy-on-close":!0,"close-on-click-modal":!1},{footer:n(()=>[l("span",re,[c(h,{onClick:o[1]||(o[1]=r=>p.value=!1)},{default:n(()=>[y(d(s(e)("cancel")),1)]),_:1}),c(h,{type:"primary",onClick:D},{default:n(()=>[y(d(s(e)("confirm")),1)]),_:1})])]),default:n(()=>[l("div",te,[l("div",oe,[i.goods_cover_thumb_small?(_(),x(u,{key:0,class:"w-[70px] h-[70px]",src:s(Z)(i.goods_cover_thumb_small),fit:"contain"},{error:n(()=>[ae]),_:1},8,["src"])):(_(),v("img",se))]),l("div",le,[l("span",{title:i.goods_name,class:"multi-hidden"},d(i.goods_name),9,ne),l("span",ie,d(i.goods_type_name),1)])]),a.data.length>1?(_(),v("div",ce,[l("label",null,d(s(e)("batchOperationSku")),1),c(V,{modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=r=>m.value=r),clearable:"",placeholder:s(e)("stock"),class:"set-input",maxlength:"20",autofocus:!0},null,8,["modelValue","placeholder"]),c(h,{type:"primary",onClick:$},{default:n(()=>[y(d(s(e)("confirm")),1)]),_:1})])):E("",!0),q((_(),x(P,{data:a.data,size:"large","max-height":"400"},{empty:n(()=>[l("span",null,d(a.loading?"":s(e)("emptyData")),1)]),default:n(()=>[a.data.length>1?(_(),x(k,{key:0,prop:"sku_name",label:s(e)("skuName"),"min-width":"120"},null,8,["label"])):E("",!0),c(k,{prop:"price",label:s(e)("price"),"min-width":"120"},null,8,["label"]),c(k,{prop:"stock",label:s(e)("stock"),"min-width":"120"},{default:n(({row:r})=>[c(V,{modelValue:r.stock,"onUpdate:modelValue":j=>r.stock=j,clearable:"",placeholder:"0",maxlength:"10",type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"])]),_:1},8,["data"])),[[U,a.loading]])]),_:1},8,["modelValue","title"])])}}});const Se=Y(de,[["__scopeId","data-v-ac8b6475"]]);export{Se as default};
