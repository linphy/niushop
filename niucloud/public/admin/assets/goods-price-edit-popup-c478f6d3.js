import{d as O,n as P,r as q,h as u,c as v,e as i,w as r,a as d,i as f,t as p,u as s,N as e,I as N,R as z,B as E,y as F,a3 as m,V as M,W as R,E as W,ah as A,aj as H,aa as J,$ as K,p as Q,g as X}from"./index-a2233f8b.js";/* empty css                   *//* empty css                   *//* empty css                        *//* empty css                    *//* empty css               */import"./el-tooltip-4ed993c7.js";/* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                 *//* empty css                        */import{_ as T}from"./goods_default-664bb559.js";import{p as Y,q as ee}from"./goods-b7f9d4bf.js";import{_ as te}from"./_plugin-vue_export-helper-c27b6911.js";const ae=y=>(Q("data-v-fd43c349"),y=y(),X(),y),oe={class:"flex items-center mb-[10px]"},le={class:"min-w-[70px] h-[70px] flex items-center justify-center"},se=ae(()=>d("div",{class:"image-slot"},[d("img",{class:"w-[70px] h-[70px]",src:T})],-1)),ie={key:1,class:"w-[70px] h-[70px]",src:T,fit:"contain"},re={class:"ml-2"},ne=["title"],ce={class:"text-primary text-[12px]"},pe={key:0,class:"batch-operation-sku"},de={key:0},me={key:1},_e={class:"dialog-footer"},ue=O({__name:"goods-price-edit-popup",emits:["load"],setup(y,{expose:C,emit:B}){const _=P({}),h=q(!1),n=P({loading:!0,data:[]}),o=P({field:"",value:""}),w=(a,t)=>{o.field=a,o.value=""},$=()=>{o.field="",o.value=""},U=()=>{if(o.value.length==0){m({type:"warning",message:`${e(o.field+"Placeholder")}`});return}if(!b.digit.test(o.value)){m({type:"warning",message:`${e(o.field+"Tips")}`});return}if(o.value<0){m({type:"warning",message:`${e(o.field+"NotZeroTips")}`});return}n.data.forEach(a=>{a[o.field]=o.value}),$()},I=()=>{n.loading=!0,ee({goods_id:_.goods_id}).then(a=>{n.loading=!1,n.data=a.data}).catch(()=>{n.loading=!1})},S=a=>{Object.assign(_,a),I(),h.value=!0},b={digit:/^\d{0,10}(.?\d{0,2})$/},D=()=>{let a=!0;for(let t=0;t<n.data.length;t++){const c=n.data[t];if(isNaN(c.price)||!b.digit.test(c.price)){a=!1,m({type:"warning",message:`${e("priceTips")}`});break}else if(c.price<0){a=!1,m({type:"warning",message:`${e("priceNotZeroTips")}`});break}if(isNaN(c.market_price)||!b.digit.test(c.market_price)){a=!1,m({type:"warning",message:`${e("marketPriceTips")}`});break}else if(c.market_price<0){a=!1,m({type:"warning",message:`${e("marketPriceNotZeroTips")}`});break}if(isNaN(c.cost_price)||!b.digit.test(c.cost_price)){a=!1,m({type:"warning",message:`${e("costPriceTips")}`});break}else if(c.cost_price<0){a=!1,m({type:"warning",message:`${e("costPriceNotZeroTips")}`});break}}return a},L=()=>{if(D()){let a=[];n.data.forEach(t=>{a.push({sku_id:t.sku_id,price:t.price,market_price:t.market_price,cost_price:t.cost_price})}),Y({goods_id:_.goods_id,sku_list:a}).then(t=>{B("load"),h.value=!1})}};return C({showDialog:h,show:S}),(a,t)=>{const c=M,x=R,g=W,V=A,Z=H,j=J,G=K;return u(),v("div",null,[i(j,{modelValue:h.value,"onUpdate:modelValue":t[5]||(t[5]=l=>h.value=l),title:s(e)("editPricePopupTitle"),width:"800px","close-on-press-escape":!1,"destroy-on-close":!0,"close-on-click-modal":!1},{footer:r(()=>[d("span",_e,[i(g,{onClick:t[4]||(t[4]=l=>h.value=!1)},{default:r(()=>[f(p(s(e)("cancel")),1)]),_:1}),i(g,{type:"primary",onClick:L},{default:r(()=>[f(p(s(e)("confirm")),1)]),_:1})])]),default:r(()=>[d("div",oe,[d("div",le,[_.goods_cover_thumb_small?(u(),N(c,{key:0,class:"w-[70px] h-[70px]",src:s(z)(_.goods_cover_thumb_small),fit:"contain"},{error:r(()=>[se]),_:1},8,["src"])):(u(),v("img",ie))]),d("div",re,[d("span",{title:_.goods_name,class:"multi-hidden"},p(_.goods_name),9,ne),d("span",ce,p(_.goods_type_name),1)])]),n.data.length>1?(u(),v("div",pe,[d("label",null,p(s(e)("batchOperationSku")),1),o.field?(u(),v("div",de,[i(x,{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=l=>o.value=l),clearable:"",placeholder:s(e)(o.field),class:"set-input",maxlength:"20",autofocus:!0},null,8,["modelValue","placeholder"]),i(g,{type:"primary",onClick:U},{default:r(()=>[f(p(s(e)("confirm")),1)]),_:1}),i(g,{onClick:$},{default:r(()=>[f(p(s(e)("cancel")),1)]),_:1})])):(u(),v("div",me,[i(g,{type:"primary",link:"",onClick:t[1]||(t[1]=l=>w("price"))},{default:r(()=>[f(p(s(e)("price")),1)]),_:1}),i(g,{type:"primary",link:"",onClick:t[2]||(t[2]=l=>w("marketPrice"))},{default:r(()=>[f(p(s(e)("marketPrice")),1)]),_:1}),i(g,{type:"primary",link:"",onClick:t[3]||(t[3]=l=>w("costPrice"))},{default:r(()=>[f(p(s(e)("costPrice")),1)]),_:1})]))])):E("",!0),F((u(),N(Z,{data:n.data,size:"large","max-height":"400"},{empty:r(()=>[d("span",null,p(n.loading?"":s(e)("emptyData")),1)]),default:r(()=>[n.data.length>1?(u(),N(V,{key:0,prop:"sku_name",label:s(e)("skuName"),"min-width":"120"},null,8,["label"])):E("",!0),i(V,{prop:"price",label:s(e)("price"),"min-width":"120"},{default:r(({row:l})=>[i(x,{modelValue:l.price,"onUpdate:modelValue":k=>l.price=k,clearable:"",placeholder:"0.00",maxlength:"10",type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),i(V,{prop:"market_price",label:s(e)("marketPrice"),"min-width":"120"},{default:r(({row:l})=>[i(x,{modelValue:l.market_price,"onUpdate:modelValue":k=>l.market_price=k,clearable:"",placeholder:"0.00",maxlength:"10",type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),i(V,{prop:"cost_price",label:s(e)("costPrice"),"min-width":"120"},{default:r(({row:l})=>[i(x,{modelValue:l.cost_price,"onUpdate:modelValue":k=>l.cost_price=k,clearable:"",placeholder:"0.00",maxlength:"10",type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"])]),_:1},8,["data"])),[[G,n.loading]])]),_:1},8,["modelValue","title"])])}}});const Be=te(ue,[["__scopeId","data-v-fd43c349"]]);export{Be as default};
