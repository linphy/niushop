import{d as pe,v as ue,f as me,l as T,M as O,k as a,r as h,bb as ce,h as p,c as b,e as o,w as r,a as w,t as d,u as t,i as m,F as E,O as N,m as v,J as fe,B as U,bc as _e,S as ge,E as ye,D as he,G as be,$ as ve,ad as we,H as Pe,K as Ve,a0 as ke,a1 as Ce,a2 as xe,V as De,a8 as Te,a9 as Ee,L as Ue}from"./index-e4c6b343.js";/* empty css                   */import Se from"./index-9e2d8138.js";/* empty css                    *//* empty css                  *//* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                *//* empty css                */import"./el-form-item-4ed993c7.js";/* empty css                  */import{h as $e,j as Fe,k as Ne,s as Re,l as Be,m as Ae}from"./diy-d3fed6ab.js";/* empty css                        */import"./index.vue_vue_type_style_index_0_lang-292103dc.js";import"./attachment-67ac687b.js";import"./index.vue_vue_type_script_setup_true_lang-86bfb907.js";/* empty css                 *//* empty css               *//* empty css                    *//* empty css                         */import"./index.vue_vue_type_script_setup_true_lang-97d3565f.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_lang-db88af80.js";import"./sys-713c5075.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./sortable.esm-be94e56d.js";const Ie={class:"main-container"},ze={class:"flex justify-between items-center"},Me={class:"text-page-title"},qe={key:0},Le={key:0,class:"text-primary"},je={key:1},Ge={class:"mt-[16px] flex justify-end"},Oe={class:"dialog-footer"},Je={class:"dialog-footer"},Ul=pe({__name:"list",setup(Ye){const J=ue(),S=me(),Y=J.meta.title,k=T({}),g=T({title:"",type:""}),H=O(()=>({title:[{required:!0,message:a("titlePlaceholder"),trigger:"blur"}],type:[{required:!0,message:a("pageTypePlaceholder"),trigger:"blur"}]})),R=h(),C=h(!1),K=async n=>{n&&await n.validate(async e=>{if(e){const s={type:g.type,title:g.title},P=S.resolve({path:"/decorate/edit",query:s});window.open(P.href),C.value=!1,g.title="",g.type=""}})},B=(n="")=>{Fe({mode:"",addon:n}).then(e=>{for(let s in k)delete k[s];for(const s in e.data)k[s]=e.data[s]})};B();const A=T({});$e().then(n=>{if(n.data)for(const e in n.data)A[e]=n.data[e]});const Q=n=>{i.searchParam.type="",B(n)},i=T({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{title:"",type:"",mode:"",addon_name:""}}),I=h(),y=(n=1)=>{i.loading=!0,i.page=n,Ne({page:i.page,limit:i.limit,...i.searchParam}).then(e=>{i.loading=!1,i.data=e.data.data,i.total=e.data.total,_e(i.page,i.limit,i.searchParam)}).catch(()=>{i.loading=!1})};y(ce(i.searchParam).page);const W=n=>{const e=S.resolve({path:"/decorate/edit",query:{id:n.id}});window.open(e.href)},X=n=>{Re({id:n}).then(()=>{y()})},Z=n=>{ge.confirm(a("diyPageDeleteTips"),a("warning"),{confirmButtonText:a("confirm"),cancelButtonText:a("cancel"),type:"warning"}).then(()=>{Be(n).then(()=>{y()}).catch(()=>{})})},ee=n=>{const e=S.resolve({path:"/preview/wap",query:{page:n.type_page+"?id="+n.id}});window.open(e.href)},c=h("wechat"),z=h(""),M=h(0),f=T({wechat:{title:"",desc:"",url:""},weapp:{title:"",url:""}}),x=h(!1),le=O(()=>({})),q=h(),ae=async n=>{M.value=n.id,z.value=n.title;const e=n.share?JSON.parse(n.share):{wechat:{title:"",desc:"",url:""},weapp:{title:"",url:""}};e&&(f.wechat=e.wechat,f.weapp=e.weapp),x.value=!0},te=async n=>{n&&await n.validate(async e=>{e&&Ae({id:M.value,share:JSON.stringify(f)}).then(()=>{y(),x.value=!1}).catch(()=>{})})},oe=n=>{n&&(n.resetFields(),y())};return(n,e)=>{const s=ye,P=he,_=be,D=ve,$=we,F=Pe,L=Ve,V=ke,re=Ce,ne=xe,j=De,G=Te,ie=Ee,se=Se,de=Ue;return p(),b("div",Ie,[o(L,{class:"box-card !border-none",shadow:"never"},{default:r(()=>[w("div",ze,[w("span",Me,d(t(Y)),1),o(s,{type:"primary",class:"w-[100px]",onClick:e[0]||(e[0]=l=>C.value=!0)},{default:r(()=>[m(d(t(a)("addDiyPage")),1)]),_:1})]),o(L,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:r(()=>[o(F,{inline:!0,model:i.searchParam,ref_key:"searchFormDiyPageRef",ref:I},{default:r(()=>[o(_,{label:t(a)("title"),prop:"title"},{default:r(()=>[o(P,{modelValue:i.searchParam.title,"onUpdate:modelValue":e[1]||(e[1]=l=>i.searchParam.title=l),modelModifiers:{trim:!0},placeholder:t(a)("titlePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(_,{label:t(a)("forAddon"),prop:"addon_name"},{default:r(()=>[o($,{modelValue:i.searchParam.addon_name,"onUpdate:modelValue":e[2]||(e[2]=l=>i.searchParam.addon_name=l),placeholder:t(a)("forAddonPlaceholder"),onChange:Q},{default:r(()=>[o(D,{label:t(a)("all"),value:""},null,8,["label"]),(p(!0),b(E,null,N(A,(l,u)=>(p(),v(D,{label:l.title,value:u,key:u},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(_,{label:t(a)("typeName"),prop:"type"},{default:r(()=>[o($,{modelValue:i.searchParam.type,"onUpdate:modelValue":e[3]||(e[3]=l=>i.searchParam.type=l),placeholder:t(a)("pageTypePlaceholder")},{default:r(()=>[o(D,{label:t(a)("all"),value:""},null,8,["label"]),(p(!0),b(E,null,N(k,(l,u)=>(p(),v(D,{label:l.title,value:u,key:u},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(_,null,{default:r(()=>[o(s,{type:"primary",onClick:e[4]||(e[4]=l=>y())},{default:r(()=>[m(d(t(a)("search")),1)]),_:1}),o(s,{onClick:e[5]||(e[5]=l=>oe(I.value))},{default:r(()=>[m(d(t(a)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),fe((p(),v(re,{data:i.data,size:"large"},{empty:r(()=>[w("span",null,d(i.loading?"":t(a)("emptyData")),1)]),default:r(()=>[o(V,{prop:"page_title",label:t(a)("title"),"min-width":"120"},null,8,["label"]),o(V,{prop:"addon_name",label:t(a)("forAddon"),"min-width":"80"},null,8,["label"]),o(V,{prop:"type_name",label:t(a)("typeName"),"min-width":"80"},null,8,["label"]),o(V,{label:t(a)("status"),"min-width":"80"},{default:r(({row:l})=>[l.type=="DIY_PAGE"?(p(),b("span",qe,"-")):(p(),b(E,{key:1},[l.is_default==1?(p(),b("span",Le,d(t(a)("isUse")),1)):(p(),b("span",je,d(t(a)("unused")),1))],64))]),_:1},8,["label"]),o(V,{prop:"update_time",label:t(a)("updateTime"),"min-width":"120"},null,8,["label"]),o(V,{label:t(a)("operation"),fixed:"right",align:"right","min-width":"160"},{default:r(({row:l})=>[o(s,{type:"primary",link:"",onClick:u=>ee(l)},{default:r(()=>[m(d(t(a)("preview")),1)]),_:2},1032,["onClick"]),l.is_default==0?(p(),v(s,{key:0,type:"primary",link:"",onClick:u=>X(l.id)},{default:r(()=>[m(d(t(a)("use")),1)]),_:2},1032,["onClick"])):U("",!0),l.type=="DIY_PAGE"?(p(),v(s,{key:1,type:"primary",link:"",onClick:u=>ae(l)},{default:r(()=>[m(d(t(a)("shareSet")),1)]),_:2},1032,["onClick"])):U("",!0),o(s,{type:"primary",link:"",onClick:u=>W(l)},{default:r(()=>[m(d(t(a)("edit")),1)]),_:2},1032,["onClick"]),l.is_default==0||l.type=="DIY_PAGE"?(p(),v(s,{key:2,type:"primary",link:"",onClick:u=>Z(l.id)},{default:r(()=>[m(d(t(a)("delete")),1)]),_:2},1032,["onClick"])):U("",!0)]),_:1},8,["label"])]),_:1},8,["data"])),[[de,i.loading]]),w("div",Ge,[o(ne,{"current-page":i.page,"onUpdate:current-page":e[6]||(e[6]=l=>i.page=l),"page-size":i.limit,"onUpdate:page-size":e[7]||(e[7]=l=>i.limit=l),layout:"total, sizes, prev, pager, next, jumper",total:i.total,onSizeChange:e[8]||(e[8]=l=>y()),onCurrentChange:y},null,8,["current-page","page-size","total"])])]),_:1}),o(j,{modelValue:C.value,"onUpdate:modelValue":e[13]||(e[13]=l=>C.value=l),title:t(a)("addPageTips"),width:"350px"},{footer:r(()=>[w("span",Oe,[o(s,{onClick:e[11]||(e[11]=l=>C.value=!1)},{default:r(()=>[m(d(t(a)("cancel")),1)]),_:1}),o(s,{type:"primary",onClick:e[12]||(e[12]=l=>K(R.value))},{default:r(()=>[m(d(t(a)("confirm")),1)]),_:1})])]),default:r(()=>[o(F,{model:g,"label-width":"90px",ref_key:"formRef",ref:R,rules:t(H)},{default:r(()=>[o(_,{label:t(a)("title"),prop:"title"},{default:r(()=>[o(P,{modelValue:g.title,"onUpdate:modelValue":e[9]||(e[9]=l=>g.title=l),modelModifiers:{trim:!0},placeholder:t(a)("titlePlaceholder"),clearable:"",maxlength:"12","show-word-limit":"",class:"w-full"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(_,{label:t(a)("typeName"),prop:"type"},{default:r(()=>[o($,{modelValue:g.type,"onUpdate:modelValue":e[10]||(e[10]=l=>g.type=l),placeholder:t(a)("pageTypePlaceholder"),class:"!w-full"},{default:r(()=>[(p(!0),b(E,null,N(k,(l,u)=>(p(),v(D,{label:l.title,value:u,key:u},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),o(j,{modelValue:x.value,"onUpdate:modelValue":e[20]||(e[20]=l=>x.value=l),title:t(a)("shareSet"),width:"30%"},{footer:r(()=>[w("span",Je,[o(s,{onClick:e[18]||(e[18]=l=>x.value=!1)},{default:r(()=>[m(d(t(a)("cancel")),1)]),_:1}),o(s,{type:"primary",onClick:e[19]||(e[19]=l=>te(q.value))},{default:r(()=>[m(d(t(a)("confirm")),1)]),_:1})])]),default:r(()=>[o(ie,{modelValue:c.value,"onUpdate:modelValue":e[14]||(e[14]=l=>c.value=l)},{default:r(()=>[o(G,{label:t(a)("wechat"),name:"wechat"},null,8,["label"]),o(G,{label:t(a)("weapp"),name:"weapp"},null,8,["label"])]),_:1},8,["modelValue"]),o(F,{model:f[c.value],"label-width":"90px",ref_key:"shareFormRef",ref:q,rules:t(le)},{default:r(()=>[o(_,{label:t(a)("sharePage")},{default:r(()=>[w("span",null,d(z.value),1)]),_:1},8,["label"]),o(_,{label:t(a)("shareTitle"),prop:"title"},{default:r(()=>[o(P,{modelValue:f[c.value].title,"onUpdate:modelValue":e[15]||(e[15]=l=>f[c.value].title=l),modelModifiers:{trim:!0},placeholder:t(a)("shareTitlePlaceholder"),clearable:"",maxlength:"30","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),c.value=="wechat"?(p(),v(_,{key:0,label:t(a)("shareDesc"),prop:"desc"},{default:r(()=>[o(P,{modelValue:f[c.value].desc,"onUpdate:modelValue":e[16]||(e[16]=l=>f[c.value].desc=l),modelModifiers:{trim:!0},placeholder:t(a)("shareDescPlaceholder"),type:"textarea",rows:"4",clearable:"",maxlength:"100","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):U("",!0),o(_,{label:t(a)("shareImageUrl"),prop:"url"},{default:r(()=>[o(se,{modelValue:f[c.value].url,"onUpdate:modelValue":e[17]||(e[17]=l=>f[c.value].url=l),limit:1},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{Ul as default};
