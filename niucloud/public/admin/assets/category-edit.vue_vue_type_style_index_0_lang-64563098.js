import{d as U,r as m,n as q,q as P,N as l,h as _,I as f,w as r,a as O,e as o,i as h,t as V,u as n,y as R,c as $,F as j,G as A,W as G,X as T,as as W,aE as X,aL as Y,Y as z,E as H,aa as J,$ as K}from"./index-a2233f8b.js";/* empty css                   *//* empty css                   *//* empty css                  *//* empty css                *//* empty css                  */import{_ as M}from"./index-58cd4749.js";/* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  */import"./el-form-item-4ed993c7.js";import{i as Q,k as Z,l as ee,m as ae}from"./goods-b7f9d4bf.js";const te={class:"dialog-footer"},we=U({__name:"category-edit",emits:["complete"],setup(le,{expose:E,emit:C}){const u=m(!1),s=m(!1),g=m(""),y={category_id:"",category_name:"",image:"",pid:0,is_show:1,child_count:0,level:1},a=q({...y}),v=m(),D=P(()=>({category_id:[{required:!0,message:l("categoryIdPlaceholder"),trigger:"blur"}],category_name:[{required:!0,message:l("categoryNamePlaceholder"),trigger:"blur"}],pid:[{required:!0,message:l("pidPlaceholder"),trigger:"change"}]})),b=m([]),F=async i=>{if(s.value||!i)return;const e=a.category_id?Q:Z;await i.validate(async d=>{d&&(s.value=!0,e(a).then(p=>{s.value=!1,u.value=!1,C("complete")}).catch(p=>{s.value=!1}))})},k=()=>{ae({level:1}).then(i=>{b.value=i.data.filter(e=>e.category_id!=a.category_id)})};return E({showDialog:u,setFormData:async(i=null)=>{if(Object.assign(a,y),s.value=!0,i){g.value=l("updateCategory");const e=await(await ee(i.category_id)).data;e&&Object.keys(a).forEach(d=>{e[d]!=null&&(a[d]=e[d])})}else g.value=l("addCategory");k(),s.value=!1}}),(i,e)=>{const d=G,c=T,p=W,x=X,N=M,B=Y,I=z,w=H,L=J,S=K;return _(),f(L,{modelValue:u.value,"onUpdate:modelValue":e[6]||(e[6]=t=>u.value=t),title:g.value,width:"480",class:"diy-dialog-wrap","destroy-on-close":!0},{footer:r(()=>[O("span",te,[o(w,{onClick:e[4]||(e[4]=t=>u.value=!1)},{default:r(()=>[h(V(n(l)("cancel")),1)]),_:1}),o(w,{type:"primary",loading:s.value,onClick:e[5]||(e[5]=t=>F(v.value))},{default:r(()=>[h(V(n(l)("confirm")),1)]),_:1},8,["loading"])])]),default:r(()=>[R((_(),f(I,{model:a,"label-width":"120px",ref_key:"formRef",ref:v,rules:n(D),class:"page-form"},{default:r(()=>[o(c,{label:n(l)("categoryName"),prop:"category_name"},{default:r(()=>[o(d,{modelValue:a.category_name,"onUpdate:modelValue":e[0]||(e[0]=t=>a.category_name=t),clearable:"",placeholder:n(l)("categoryNamePlaceholder"),class:"input-width",maxlength:"10","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(c,{label:n(l)("pid"),prop:"pid"},{default:r(()=>[o(x,{modelValue:a.pid,"onUpdate:modelValue":e[1]||(e[1]=t=>a.pid=t),clearable:"",disabled:!!a.child_count,placeholder:"Select",class:"input-width"},{default:r(()=>[o(p,{label:"顶级分类",value:0}),(_(!0),$(j,null,A(b.value,t=>(_(),f(p,{key:t.category_id,label:t.category_name,value:t.category_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["label"]),o(c,{label:n(l)("image")},{default:r(()=>[o(N,{modelValue:a.image,"onUpdate:modelValue":e[2]||(e[2]=t=>a.image=t)},null,8,["modelValue"])]),_:1},8,["label"]),o(c,{label:n(l)("isShow"),prop:"is_show"},{default:r(()=>[o(B,{modelValue:a.is_show,"onUpdate:modelValue":e[3]||(e[3]=t=>a.is_show=t),class:"input-width","active-value":1,"inactive-value":2},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[S,s.value]])]),_:1},8,["modelValue","title"])}}});export{we as _};
