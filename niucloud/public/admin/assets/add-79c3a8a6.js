import{d as I,f as $,r as y,q as F,N as d,h as G,c as j,a as n,u as i,t as m,e as l,w as a,cP as w,i as u,y as _,z as v,cM as M,W,X,ay as Y,az as A,cI as H,cK as J,Y as O,_ as Q,E as Z}from"./index-1d549745.js";/* empty css                  *//* empty css                *//* empty css                     *//* empty css                       *//* empty css                 *//* empty css                     *//* empty css                  *//* empty css                          *//* empty css               *//* empty css                    *//* empty css                 *//* empty css                       */import{g as ee,a as le}from"./marketing-2e804786.js";import te from"./goods-select-popup-aeb12c21.js";/* empty css                   *//* empty css                   *//* empty css                      *//* empty css                  *//* empty css                  *//* empty css                        */import"./el-tooltip-4ed993c7.js";/* empty css                 *//* empty css                        */import"./goods_default-664bb559.js";import"./goods-af228f6a.js";import"./_plugin-vue_export-helper-c27b6911.js";const ae={class:"main-container"},oe={class:"detail-head"},ie=n("span",{class:"iconfont iconxiangzuojiantou !text-xs"},null,-1),de={class:"ml-[1px]"},ue=n("span",{class:"adorn"},"|",-1),re={class:"right"},ne={class:"flex items-center",style:{"padding-left":"5px"}},se={class:"flex items-center",style:{"padding-left":"5px"}},pe={class:"w-[220px]",style:{"padding-left":"5px"}},me=n("div",{class:"form-tip"},"开启手动领取后，会员可以直接在优惠券列表以及优惠券推广中直接领取",-1),_e={class:"w-[180px]"},ve=n("div",{class:"form-tip"},"最多发放100000张",-1),ce={class:"fixed-footer-wrap"},fe={class:"fixed-footer"},We=I({__name:"add",setup(ye){const U=$(),g=y(!1),k=y(null),P=new Date,V=new Date;V.setTime(V.getTime()+3600*1e3*2*360);const e=y({title:"",price:"",type:1,limit:2,receive_type:1,remain_count:1e3,threshold:2,limit_count:1,min_condition_money:1,length:30,goods_ids:[],goods_category_ids:[],receive_type_time:2,valid_type:1,receive_time:[P,V],valid_time:V}),b=y(),E=F(()=>({title:[{required:!0,message:d("titlePlaceholder"),trigger:"blur"}],price:[{required:!0,validator:T,trigger:"blur"}],remain_count:[{required:!0,validator:R,trigger:"blur"}],limit_count:[{required:!0,validator:S,trigger:"blur"}]})),R=(c,t,s)=>{e.value.remain_count!=""&&e.value.remain_count>1e5&&s(new Error(d("remainCountPlaceholder"))),s()},T=(c,t,s)=>{e.value.price!=""&&e.value.price<.01&&s(new Error(d("pricePlaceholder"))),s()},S=(c,t,s)=>{e.value.limit_count!=""&&e.value.limit_count<1&&s(new Error(d("userLimitCountPlaceholder"))),s()},D={multiple:!0},h=y([]),N=()=>{ee({}).then(c=>{h.value=c.data.goods_category_tree})},q=async c=>{g.value||!c||await c.validate(async t=>{if(t){g.value=!0;const s=e.value;le(s).then(p=>{g.value=!1,history.back()}).catch(p=>{g.value=!1})}})},L=()=>{history.back()};return(c,t)=>{const s=W,r=X,p=Y,f=A,B=H,x=J,K=O,z=Q,C=Z;return G(),j("div",ae,[n("div",oe,[n("div",{class:"left",onClick:t[0]||(t[0]=o=>i(U).push("/shop/marketing/coupon/list"))},[ie,n("span",de,m(i(d)("returnToPreviousPage")),1)]),ue,n("span",re,m(i(d)("addCoupon")),1)]),l(z,{class:"box-card !border-none",shadow:"never"},{default:a(()=>[l(K,{model:e.value,"label-width":"120px",ref_key:"formRef",ref:b,rules:i(E),class:"page-form"},{default:a(()=>[l(r,{label:i(d)("title"),prop:"title"},{default:a(()=>[l(s,{modelValue:e.value.title,"onUpdate:modelValue":t[1]||(t[1]=o=>e.value.title=o),clearable:"",placeholder:i(d)("titlePlaceholder"),class:"input-width",maxlength:20},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(r,{label:i(d)("price"),prop:"price"},{default:a(()=>[l(s,{modelValue:e.value.price,"onUpdate:modelValue":t[2]||(t[2]=o=>e.value.price=o),clearable:"",placeholder:i(d)("pricePlaceholder"),class:"input-width",maxlength:"60",onKeyup:t[3]||(t[3]=o=>i(w)(o))},{append:a(()=>[u("元")]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),l(r,{label:i(d)("type"),prop:"type"},{default:a(()=>[l(f,{modelValue:e.value.type,"onUpdate:modelValue":t[4]||(t[4]=o=>e.value.type=o)},{default:a(()=>[l(p,{label:1},{default:a(()=>[u("通用券")]),_:1}),l(p,{label:2,onClick:N},{default:a(()=>[u("品类券")]),_:1}),l(p,{label:3},{default:a(()=>[u("商品券")]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),_(l(r,null,{default:a(()=>[n("div",null,[l(B,{modelValue:e.value.goods_category_ids,"onUpdate:modelValue":t[5]||(t[5]=o=>e.value.goods_category_ids=o),options:h.value,props:D,placeholder:"请选择商品分类","collapse-tags":"","collapse-tags-tooltip":"",clearable:""},null,8,["modelValue","options"])])]),_:1},512),[[v,e.value.type==2]]),_(l(r,null,{default:a(()=>[n("div",null,[l(r,null,{default:a(()=>[l(te,{ref_key:"goodsSelectPopupRef",ref:k,modelValue:e.value.goods_ids,"onUpdate:modelValue":t[6]||(t[6]=o=>e.value.goods_ids=o),min:1,max:99},null,8,["modelValue"])]),_:1})])]),_:1},512),[[v,e.value.type==3]]),l(r,{label:i(d)("threshold")},{default:a(()=>[l(f,{modelValue:e.value.threshold,"onUpdate:modelValue":t[7]||(t[7]=o=>e.value.threshold=o)},{default:a(()=>[l(p,{label:1},{default:a(()=>[u(m(i(d)("reduction")),1)]),_:1}),l(p,{label:2},{default:a(()=>[u(m(i(d)("noThreshold")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),_(l(r,null,{default:a(()=>[u(" 最低满 "),n("div",ne,[l(s,{modelValue:e.value.min_condition_money,"onUpdate:modelValue":t[8]||(t[8]=o=>e.value.min_condition_money=o),onKeyup:t[9]||(t[9]=o=>i(w)(o)),clearable:"",class:"!w-[100px]"},null,8,["modelValue"])]),u(" 元可用 ")]),_:1},512),[[v,e.value.threshold==1]]),l(r,{label:i(d)("validType")},{default:a(()=>[l(f,{modelValue:e.value.valid_type,"onUpdate:modelValue":t[10]||(t[10]=o=>e.value.valid_type=o)},{default:a(()=>[l(p,{label:1},{default:a(()=>[u(m(i(d)("days")),1)]),_:1}),l(p,{label:2},{default:a(()=>[u(m(i(d)("times")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),_(l(r,null,{default:a(()=>[u(" 领劵后立即生效，有效期 "),n("div",se,[l(s,{modelValue:e.value.length,"onUpdate:modelValue":t[11]||(t[11]=o=>e.value.length=o),onKeyup:t[12]||(t[12]=o=>i(M)(o)),clearable:"",class:"!w-[100px]"},null,8,["modelValue"]),u(" 天 ")])]),_:1},512),[[v,e.value.valid_type==1]]),_(l(r,{prop:"valid_time"},{default:a(()=>[u(" 领劵后立即生效，使用时间截止至 "),n("div",pe,[l(x,{modelValue:e.value.valid_time,"onUpdate:modelValue":t[13]||(t[13]=o=>e.value.valid_time=o),type:"datetime"},null,8,["modelValue"])])]),_:1},512),[[v,e.value.valid_type==2]]),l(r,{label:i(d)("receiveType")},{default:a(()=>[n("div",null,[l(f,{modelValue:e.value.receive_type,"onUpdate:modelValue":t[14]||(t[14]=o=>e.value.receive_type=o)},{default:a(()=>[l(p,{label:1},{default:a(()=>[u(m(i(d)("user")),1)]),_:1}),l(p,{label:2},{default:a(()=>[u(m(i(d)("grant")),1)]),_:1})]),_:1},8,["modelValue"])]),me]),_:1},8,["label"]),_(l(r,{label:i(d)("receiveTime")},{default:a(()=>[l(f,{modelValue:e.value.receive_type_time,"onUpdate:modelValue":t[15]||(t[15]=o=>e.value.receive_type_time=o)},{default:a(()=>[l(p,{label:1},{default:a(()=>[u(m(i(d)("limitedTime")),1)]),_:1}),l(p,{label:2},{default:a(()=>[u(m(i(d)("unlimitedTime")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),[[v,e.value.receive_type==1]]),_(l(r,{prop:"receive_time"},{default:a(()=>[n("div",_e,[l(x,{modelValue:e.value.receive_time,"onUpdate:modelValue":t[16]||(t[16]=o=>e.value.receive_time=o),type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])])]),_:1},512),[[v,e.value.receive_type_time==1&&e.value.receive_type==1]]),_(l(r,{label:i(d)("receiveNumber")},{default:a(()=>[l(f,{modelValue:e.value.limit,"onUpdate:modelValue":t[17]||(t[17]=o=>e.value.limit=o)},{default:a(()=>[l(p,{label:1},{default:a(()=>[u(m(i(d)("limit")),1)]),_:1}),l(p,{label:2},{default:a(()=>[u(m(i(d)("unlimited")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),[[v,e.value.receive_type==1]]),_(l(r,{prop:"remain_count"},{default:a(()=>[n("div",null,[l(s,{onkeypress:"return( /[\\d]/.test(String.fromCharCode(event.keyCode) ) )",modelValue:e.value.remain_count,"onUpdate:modelValue":t[18]||(t[18]=o=>e.value.remain_count=o),clearable:"",placeholder:i(d)("remainCountPlaceholder"),class:"input-width",min:1,max:1e5,controls:!1},{append:a(()=>[u("张")]),_:1},8,["modelValue","placeholder"])]),ve]),_:1},512),[[v,e.value.limit==1&&e.value.receive_type==1]]),_(l(r,{label:i(d)("userLimitCount"),prop:"limit_count"},{default:a(()=>[l(s,{onkeypress:"return( /[\\d]/.test(String.fromCharCode(event.keyCode) ) )",modelValue:e.value.limit_count,"onUpdate:modelValue":t[19]||(t[19]=o=>e.value.limit_count=o),clearable:"",placeholder:i(d)("userLimitCountPlaceholder"),class:"input-width",min:1,max:1e5},{append:a(()=>[u("张")]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),[[v,e.value.receive_type==1]])]),_:1},8,["model","rules"])]),_:1}),n("div",ce,[n("div",fe,[l(C,{type:"primary",onClick:t[20]||(t[20]=o=>q(b.value))},{default:a(()=>[u(m(i(d)("save")),1)]),_:1}),l(C,{onClick:t[21]||(t[21]=o=>L())},{default:a(()=>[u(m(i(d)("cancel")),1)]),_:1})])])])}}});export{We as default};
