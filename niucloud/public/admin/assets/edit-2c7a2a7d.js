import{d as G,O as K,f as M,r as g,q as W,N as i,v as X,y as _,h as k,c as Y,a as d,u,t as m,I as A,w as a,e as l,i as r,z as c,B as H,W as J,X as Q,ay as Z,az as ee,cI as le,cK as te,Y as ae,_ as oe,E as ie,$ as ue}from"./index-a2233f8b.js";/* empty css                   *//* empty css                  *//* empty css                *//* empty css                *//* empty css                       *//* empty css                 *//* empty css                     *//* empty css                  *//* empty css                          *//* empty css               *//* empty css                    *//* empty css                 *//* empty css                       */import"./el-form-item-4ed993c7.js";import{c as re,g as ne,e as de}from"./marketing-04947b9e.js";import se from"./goods-select-popup-ba8baf79.js";/* empty css                   *//* empty css                      *//* empty css                  *//* empty css                  *//* empty css                        */import"./el-tooltip-4ed993c7.js";/* empty css                 *//* empty css                        */import"./goods_default-664bb559.js";import"./goods-b7f9d4bf.js";import"./_plugin-vue_export-helper-c27b6911.js";const pe={class:"main-container"},me={class:"detail-head"},_e=d("span",{class:"iconfont iconxiangzuojiantou !text-xs"},null,-1),ve={class:"ml-[1px]"},ce=d("span",{class:"adorn"},"|",-1),fe={class:"right"},ye={class:"flex items-center",style:{"padding-left":"5px"}},ge={class:"flex items-center",style:{"padding-left":"5px"}},be={class:"w-[220px]",style:{"padding-left":"5px"}},Ve=d("div",{class:"form-tip"},"开启手动领取后，会员可以直接在优惠券列表以及优惠券推广中直接领取",-1),he={class:"w-[180px]"},xe=d("div",{class:"form-tip"},"每个会员通过前端直接可领用数量",-1),Ce={class:"fixed-footer-wrap"},we={class:"fixed-footer"},ll=G({__name:"edit",setup(ke){const U=K(),P=M(),E=parseInt(U.query.id),f=g(!1),R=new Date,T=g(null),b=new Date;b.setTime(b.getTime()+3600*1e3*2*360);const e=g({...{title:"",price:"",type:1,limit:2,receive_type:2,remain_count:1e3,threshold:2,limit_count:"",min_condition_money:"",length:30,goods_ids:[],goods_category_ids:[],receive_type_time:2,valid_type:1,receive_time:[R,b],valid_time:b}}),V=g(),D=W(()=>({title:[{required:!0,message:i("titlePlaceholder"),trigger:"blur"}],price:[{required:!0,validator:S,trigger:"blur"}],remain_count:[{required:!0,validator:I,trigger:"blur"}],limit_count:[{required:!0,validator:q,trigger:"blur"}]})),I=(v,t,s)=>{e.value.remain_count!=""&&e.value.remain_count>1e5&&s(new Error(i("remainCountPlaceholder"))),s()},S=(v,t,s)=>{e.value.price!=""&&e.value.price<.01&&s(new Error(i("pricePlaceholder"))),s()},q=(v,t,s)=>{e.value.limit_count!=""&&e.value.limit_count<1&&s(new Error(i("userLimitCountPlaceholder"))),s()},B={multiple:!0},h=g([]),x=()=>{ne({}).then(v=>{h.value=v.data.goods_category_tree})};x();const L=async v=>{f.value||!v||await v.validate(async t=>{if(t){f.value=!0;const s=e.value;de(s).then(p=>{f.value=!1,history.back()}).catch(p=>{f.value=!1})}})};X(async()=>{N(E)});const N=v=>{f.value=!0,re(v).then(t=>{e.value=Object.assign(e.value,t.data),f.value=!1}).catch(()=>{f.value=!1})},F=()=>{history.back()};return(v,t)=>{const s=J,n=Q,p=Z,y=ee,$=le,C=te,j=ae,z=oe,w=ie,O=ue;return _((k(),Y("div",pe,[d("div",me,[d("div",{class:"left",onClick:t[0]||(t[0]=o=>u(P).push("/shop/marketing/coupon/list"))},[_e,d("span",ve,m(u(i)("returnToPreviousPage")),1)]),ce,d("span",fe,m(u(i)("editCoupon")),1)]),Object.keys(e.value).length?(k(),A(z,{key:0,class:"box-card !border-none page-height",shadow:"never"},{default:a(()=>[l(j,{model:e.value,"label-width":"120px",ref_key:"formRef",ref:V,rules:u(D),class:"page-form"},{default:a(()=>[l(n,{label:u(i)("title"),prop:"title"},{default:a(()=>[l(s,{modelValue:e.value.title,"onUpdate:modelValue":t[1]||(t[1]=o=>e.value.title=o),clearable:"",placeholder:u(i)("titlePlaceholder"),class:"input-width",maxlength:20},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(n,{label:u(i)("price"),prop:"price"},{default:a(()=>[l(s,{type:"number",οninput:"value=value.replace(/[^\\d.]/g,'')",modelValue:e.value.price,"onUpdate:modelValue":t[2]||(t[2]=o=>e.value.price=o),clearable:"",placeholder:u(i)("pricePlaceholder"),class:"input-width",maxlength:"60"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(n,{label:u(i)("type"),prop:"type"},{default:a(()=>[l(y,{modelValue:e.value.type,"onUpdate:modelValue":t[3]||(t[3]=o=>e.value.type=o)},{default:a(()=>[l(p,{label:1},{default:a(()=>[r("通用券")]),_:1}),l(p,{label:2,onClick:x},{default:a(()=>[r("品类券")]),_:1}),l(p,{label:3},{default:a(()=>[r("商品券")]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),_(l(n,null,{default:a(()=>[d("div",null,[l($,{modelValue:e.value.goods_category_ids,"onUpdate:modelValue":t[4]||(t[4]=o=>e.value.goods_category_ids=o),options:h.value,props:B,"collapse-tags":"","collapse-tags-tooltip":"",clearable:""},null,8,["modelValue","options"])])]),_:1},512),[[c,e.value.type==2]]),_(l(n,null,{default:a(()=>[d("div",null,[l(n,null,{default:a(()=>[l(se,{ref_key:"goodsSelectPopupRef",ref:T,modelValue:e.value.goods_ids,"onUpdate:modelValue":t[5]||(t[5]=o=>e.value.goods_ids=o),min:1,max:99},null,8,["modelValue"])]),_:1})])]),_:1},512),[[c,e.value.type==3]]),l(n,{label:u(i)("threshold")},{default:a(()=>[l(y,{modelValue:e.value.threshold,"onUpdate:modelValue":t[6]||(t[6]=o=>e.value.threshold=o)},{default:a(()=>[l(p,{label:1},{default:a(()=>[r(m(u(i)("reduction")),1)]),_:1}),l(p,{label:2},{default:a(()=>[r(m(u(i)("noThreshold")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),_(l(n,null,{default:a(()=>[r(" 最低满 "),d("div",ye,[l(s,{type:"number",οninput:"value=value.replace(/[^\\d.]/g,'')",modelValue:e.value.min_condition_money,"onUpdate:modelValue":t[7]||(t[7]=o=>e.value.min_condition_money=o),clearable:"",class:"!w-[100px]"},null,8,["modelValue"])]),r(" 元可用 ")]),_:1},512),[[c,e.value.threshold==1]]),l(n,{label:u(i)("validType")},{default:a(()=>[l(y,{modelValue:e.value.valid_type,"onUpdate:modelValue":t[8]||(t[8]=o=>e.value.valid_type=o)},{default:a(()=>[l(p,{label:1},{default:a(()=>[r(m(u(i)("days")),1)]),_:1}),l(p,{label:2},{default:a(()=>[r(m(u(i)("times")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),_(l(n,null,{default:a(()=>[r(" 领劵后立即生效，有效期 "),d("div",ge,[l(s,{type:"number",modelValue:e.value.length,"onUpdate:modelValue":t[9]||(t[9]=o=>e.value.length=o),clearable:"",class:"!w-[100px]"},null,8,["modelValue"]),r(" 天 ")])]),_:1},512),[[c,e.value.valid_type==1]]),_(l(n,{prop:"valid_time"},{default:a(()=>[r(" 领劵后立即生效，使用时间截止至 "),d("div",be,[l(C,{modelValue:e.value.valid_time,"onUpdate:modelValue":t[10]||(t[10]=o=>e.value.valid_time=o),type:"datetime",placeholder:u(i)("validTimePlaceholder")},null,8,["modelValue","placeholder"])])]),_:1},512),[[c,e.value.valid_type==2]]),l(n,{label:u(i)("receiveType")},{default:a(()=>[d("div",null,[l(y,{modelValue:e.value.receive_type,"onUpdate:modelValue":t[11]||(t[11]=o=>e.value.receive_type=o)},{default:a(()=>[l(p,{label:1},{default:a(()=>[r(m(u(i)("user")),1)]),_:1}),l(p,{label:2},{default:a(()=>[r(m(u(i)("grant")),1)]),_:1})]),_:1},8,["modelValue"])]),Ve]),_:1},8,["label"]),_(l(n,{label:u(i)("receiveTime")},{default:a(()=>[l(y,{modelValue:e.value.receive_type_time,"onUpdate:modelValue":t[12]||(t[12]=o=>e.value.receive_type_time=o)},{default:a(()=>[l(p,{label:1},{default:a(()=>[r(m(u(i)("limitedTime")),1)]),_:1}),l(p,{label:2},{default:a(()=>[r(m(u(i)("unlimitedTime")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),[[c,e.value.receive_type==1]]),_(l(n,{prop:"receive_time"},{default:a(()=>[d("div",he,[l(C,{modelValue:e.value.receive_time,"onUpdate:modelValue":t[13]||(t[13]=o=>e.value.receive_time=o),type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])])]),_:1},512),[[c,e.value.receive_type_time==1&&e.value.receive_type==1]]),_(l(n,{label:u(i)("receiveNumber")},{default:a(()=>[l(y,{modelValue:e.value.limit,"onUpdate:modelValue":t[14]||(t[14]=o=>e.value.limit=o)},{default:a(()=>[l(p,{label:1},{default:a(()=>[r(m(u(i)("limit")),1)]),_:1}),l(p,{label:2},{default:a(()=>[r(m(u(i)("unlimited")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),[[c,e.value.receive_type==1]]),_(l(n,{prop:"remain_count"},{default:a(()=>[d("div",null,[l(s,{type:"number",onkeypress:"return( /[\\d]/.test(String.fromCharCode(event.keyCode) ) )",modelValue:e.value.remain_count,"onUpdate:modelValue":t[15]||(t[15]=o=>e.value.remain_count=o),clearable:"",placeholder:u(i)("remainCountPlaceholder"),class:"input-width",min:e.value.remain_count,max:1e5,controls:!1},{append:a(()=>[r("张")]),_:1},8,["modelValue","placeholder","min"])])]),_:1},512),[[c,e.value.limit==1&&e.value.receive_type==1]]),_(l(n,{label:u(i)("userLimitCount"),prop:"limit_count"},{default:a(()=>[l(s,{type:"number",onkeypress:"return( /[\\d]/.test(String.fromCharCode(event.keyCode) ) )",modelValue:e.value.limit_count,"onUpdate:modelValue":t[16]||(t[16]=o=>e.value.limit_count=o),clearable:"",placeholder:u(i)("userLimitCountPlaceholder"),class:"input-width",min:1,max:1e5},{append:a(()=>[r("张")]),_:1},8,["modelValue","placeholder"]),xe]),_:1},8,["label"]),[[c,e.value.receive_type==1]])]),_:1},8,["model","rules"])]),_:1})):H("",!0),d("div",Ce,[d("div",we,[l(w,{type:"primary",onClick:t[17]||(t[17]=o=>L(V.value))},{default:a(()=>[r(m(u(i)("save")),1)]),_:1}),l(w,{onClick:t[18]||(t[18]=o=>F())},{default:a(()=>[r(m(u(i)("cancel")),1)]),_:1})])])])),[[O,f.value]])}}});export{ll as default};
