import{d as j,r as m,l as G,M as T,k as o,h as p,m as _,w as d,a as H,e as t,i as v,t as g,u as r,J,c as N,B,F as z,O as A,am as K,ai as Q,D as W,G as X,$ as Y,ad as Z,ab as ee,ac as le,H as ae,E as oe,V as re,L as te}from"./index-a59af0dd.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                  *//* empty css                *//* empty css                       *//* empty css                 *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  */import se from"./index-fbdf2045.js";import"./el-form-item-4ed993c7.js";import{e as de,c as ue,d as ne}from"./user-13b107e0.js";import{q as ie}from"./sys-d9b3645a.js";const me={key:0},pe={class:"dialog-footer"},xe=j({__name:"edit-user",emits:["complete"],setup(fe,{expose:C,emit:D}){const c=m(""),w=m(!0),b=m(!0),V=m(!0),f=m(!1),i=m(!1);let y="";const E={uid:0,username:"",head_img:"",real_name:"",password:"",confirm_password:"",status:1,role_ids:[],userrole:{}},l=G({...E}),P=m(),$=T(()=>({uid:[{validator:(u,e,s)=>{!l.uid&&c.value===""?s(new Error(o("managerPlaceholder"))):s()},trigger:"blur"}],username:[{required:l.uid==0,message:o("accountNumberPlaceholder"),trigger:"blur"}],real_name:[{required:!0,message:o("userRealNamePlaceholder"),trigger:"blur"}],role_ids:[{required:!0,message:o("userRolePlaceholder"),trigger:"blur"}],password:[{required:l.uid==0,message:o("passwordPlaceholder"),trigger:"blur"}],confirm_password:[{required:l.uid==0,message:o("confirmPasswordPlaceholder"),trigger:"blur"},{validator:(u,e,s)=>{e!=l.password?s(new Error(o("confirmPasswordError"))):s()},trigger:"blur"}]})),h=m([]);ie().then(u=>{h.value=u.data,h.value.forEach(e=>{e.role_id=e.role_id.toString()})});const x=async u=>{if(i.value||!u)return;const e=l.uid?de:ue;await u.validate(async s=>{if(s){i.value=!0;const n=K(Q(l));!l.uid&&typeof c.value=="number"&&(n.uid=c.value),e(n).then(U=>{i.value=!1,f.value=!1,D("complete")}).catch(()=>{i.value=!1})}})};return C({showDialog:f,setFormData:async(u=null)=>{if(i.value=!0,c.value="",Object.assign(l,E),y=o("addUser"),u){y=o("updateUser");const e=await(await ne(u.uid)).data;e.role_ids=e.role_ids||[],Object.keys(l).forEach(s=>{e[s]!=null&&(l[s]=e[s])})}i.value=!1}}),(u,e)=>{const s=W,n=X,U=se,F=Y,q=Z,R=ee,M=le,I=ae,k=oe,O=re,L=te;return p(),_(O,{modelValue:f.value,"onUpdate:modelValue":e[15]||(e[15]=a=>f.value=a),title:r(y),width:"500px","destroy-on-close":!0},{footer:d(()=>[H("span",pe,[t(k,{onClick:e[13]||(e[13]=a=>f.value=!1)},{default:d(()=>[v(g(r(o)("cancel")),1)]),_:1}),t(k,{type:"primary",loading:i.value,onClick:e[14]||(e[14]=a=>x(P.value))},{default:d(()=>[v(g(r(o)("confirm")),1)]),_:1},8,["loading"])])]),default:d(()=>[J((p(),_(I,{model:l,"label-width":"90px",ref_key:"formRef",ref:P,rules:r($),class:"page-form"},{default:d(()=>[t(n,{label:r(o)("accountNumber"),prop:"username"},{default:d(()=>[t(s,{modelValue:l.username,"onUpdate:modelValue":e[0]||(e[0]=a=>l.username=a),modelModifiers:{trim:!0},placeholder:r(o)("accountNumberPlaceholder"),clearable:"",disabled:l.uid,class:"input-width",maxlength:"10","show-word-limit":""},null,8,["modelValue","placeholder","disabled"])]),_:1},8,["label"]),t(n,{label:r(o)("headImg")},{default:d(()=>[t(U,{modelValue:l.head_img,"onUpdate:modelValue":e[1]||(e[1]=a=>l.head_img=a)},null,8,["modelValue"])]),_:1},8,["label"]),t(n,{label:r(o)("userRealName"),prop:"real_name"},{default:d(()=>[t(s,{modelValue:l.real_name,"onUpdate:modelValue":e[2]||(e[2]=a=>l.real_name=a),modelModifiers:{trim:!0},placeholder:r(o)("userRealNamePlaceholder"),readonly:w.value,onClick:e[3]||(e[3]=a=>w.value=!1),onBlur:e[4]||(e[4]=a=>w.value=!0),clearable:"",class:"input-width",maxlength:"10","show-word-limit":""},null,8,["modelValue","placeholder","readonly"])]),_:1},8,["label"]),l.uid?B("",!0):(p(),N("div",me,[t(n,{label:r(o)("password"),prop:"password"},{default:d(()=>[t(s,{modelValue:l.password,"onUpdate:modelValue":e[5]||(e[5]=a=>l.password=a),modelModifiers:{trim:!0},placeholder:r(o)("passwordPlaceholder"),readonly:b.value,onClick:e[6]||(e[6]=a=>b.value=!1),onBlur:e[7]||(e[7]=a=>b.value=!0),type:"password","show-password":!0,clearable:"",class:"input-width"},null,8,["modelValue","placeholder","readonly"])]),_:1},8,["label"]),t(n,{label:r(o)("confirmPassword"),prop:"confirm_password"},{default:d(()=>[t(s,{modelValue:l.confirm_password,"onUpdate:modelValue":e[8]||(e[8]=a=>l.confirm_password=a),modelModifiers:{trim:!0},placeholder:r(o)("confirmPasswordPlaceholder"),readonly:V.value,onClick:e[9]||(e[9]=a=>V.value=!1),onBlur:e[10]||(e[10]=a=>V.value=!0),type:"password","show-password":!0,clearable:"",class:"input-width"},null,8,["modelValue","placeholder","readonly"])]),_:1},8,["label"])])),l.userrole.is_admin?B("",!0):(p(),_(n,{key:1,label:r(o)("userRoleName"),prop:"role_ids"},{default:d(()=>[t(q,{modelValue:l.role_ids,"onUpdate:modelValue":e[11]||(e[11]=a=>l.role_ids=a),placeholder:r(o)("userRolePlaceholder"),class:"input-width",multiple:"","collapse-tags":"","collapse-tags-tooltip":""},{default:d(()=>[(p(!0),N(z,null,A(h.value,(a,S)=>(p(),_(F,{label:a.role_name,value:a.role_id,key:S},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])),t(n,{label:r(o)("status")},{default:d(()=>[t(M,{modelValue:l.status,"onUpdate:modelValue":e[12]||(e[12]=a=>l.status=a)},{default:d(()=>[t(R,{label:1},{default:d(()=>[v(g(r(o)("statusUnlock")),1)]),_:1}),t(R,{label:0},{default:d(()=>[v(g(r(o)("lock")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[L,i.value]])]),_:1},8,["modelValue","title"])}}});export{xe as _};
