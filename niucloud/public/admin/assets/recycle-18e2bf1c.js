import{d as Y,O as q,r as f,n as V,h as y,c as E,e as l,w as n,a as i,t as c,u as s,N as t,F as J,G as K,I as F,i as x,y as Q,R as Z,B as D,a3 as ee,a8 as G,cy as ae,W as te,X as oe,cI as le,as as se,aE as ne,E as re,Y as ie,_ as ce,aA as de,ah as pe,aj as me,a4 as ue,$ as ge}from"./index-1d549745.js";/* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                        *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                *//* empty css                     *//* empty css                  *//* empty css                          *//* empty css                 */import{g as _e,a as he,V as I,W as fe}from"./goods-af228f6a.js";import{_ as ye}from"./_plugin-vue_export-helper-c27b6911.js";const be={class:"main-container"},ve={class:"flex justify-between items-center"},xe={class:"text-page-title"},Ce={class:"mt-[10px]"},ke={class:"mb-[10px] flex items-center"},Ee={class:"flex items-center cursor-pointer"},Te={class:"min-w-[70px] h-[70px] flex items-center justify-center"},Ve=["src"],we={class:"ml-2"},Pe=["title"],Re={class:"text-primary text-[12px]"},Se={key:0},Be={key:1},ze={class:"mt-[16px] flex"},Ne={class:"flex items-center flex-1"},Fe=Y({__name:"recycle",setup(De){const U=q().meta.title,m=f(!1),o=V({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{goods_name:"",goods_category:[],goods_type:""}}),w=f(),T=V([]),L={checkStrictly:!0},P=V([]);(()=>{_e().then(r=>{const e=r.data;if(e){const d=[];e.forEach(p=>{const C=[];p.child_list&&p.child_list.forEach(k=>{C.push({value:k.category_id,label:k.category_name})}),d.push({value:p.category_id,label:p.category_name,children:C})}),T.splice(0,T.length,...d)}}),he().then(r=>{const e=r.data;if(e)for(const d in e)P.push(e[d])})})();const _=f(),b=f(!1),R=r=>{b.value=!1,S.value.toggleAllSelection()},S=f(),h=f([]),$=r=>{h.value=r,_.value=!1,h.value.length>0&&h.value.length<o.data.length?b.value=!0:b.value=!1,h.value.length==o.data.length&&(_.value=!0)},B=()=>{if(h.value.length==0){ee({type:"warning",message:`${t("batchEmptySelectedGoodsTips")}`});return}G.confirm(t("batchGoodsRecycleTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{if(m.value)return;m.value=!0;const r=[];h.value.forEach(e=>{r.push(e.goods_id)}),I({goods_ids:r}).then(()=>{g(),m.value=!1}).catch(()=>{m.value=!1})})},g=(r=1)=>{o.loading=!0,o.page=r;const e=ae(o.searchParam);fe({page:o.page,limit:o.limit,...e}).then(d=>{o.loading=!1,o.data=d.data.data,o.total=d.data.total}).catch(()=>{o.loading=!1})};g();const O=r=>{G.confirm(t("goodsRecycleTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{m.value||(m.value=!0,I({goods_ids:r.goods_id}).then(e=>{e.code==1&&g(),m.value=!1}).catch(e=>{m.value=!1}))})},j=r=>{r&&(r.resetFields(),g())};return(r,e)=>{const d=te,p=oe,C=le,k=se,A=ne,v=re,M=ie,z=ce,N=de,u=pe,W=me,H=ue,X=ge;return y(),E("div",be,[l(z,{class:"box-card !border-none",shadow:"never"},{default:n(()=>[i("div",ve,[i("span",xe,c(s(U)),1)]),l(z,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:n(()=>[l(M,{inline:!0,model:o.searchParam,ref_key:"searchFormRef",ref:w},{default:n(()=>[l(p,{label:s(t)("goodsName"),prop:"goods_name"},{default:n(()=>[l(d,{modelValue:o.searchParam.goods_name,"onUpdate:modelValue":e[0]||(e[0]=a=>o.searchParam.goods_name=a),placeholder:s(t)("goodsNamePlaceholder"),maxlength:"60"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(p,{label:s(t)("goodsCategory"),prop:"goods_category"},{default:n(()=>[l(C,{props:L,modelValue:o.searchParam.goods_category,"onUpdate:modelValue":e[1]||(e[1]=a=>o.searchParam.goods_category=a),options:T,placeholder:s(t)("goodsCategoryPlaceholder"),clearable:"",filterable:"",onChange:r.categoryHandleChange},null,8,["modelValue","options","placeholder","onChange"])]),_:1},8,["label"]),l(p,{label:s(t)("goodsType"),prop:"goods_type"},{default:n(()=>[l(A,{modelValue:o.searchParam.goods_type,"onUpdate:modelValue":e[2]||(e[2]=a=>o.searchParam.goods_type=a),placeholder:s(t)("goodsTypePlaceholder"),clearable:""},{default:n(()=>[(y(!0),E(J,null,K(P,a=>(y(),F(k,{key:a.type,label:a.name,value:a.type},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),l(p,null,{default:n(()=>[l(v,{type:"primary",onClick:e[3]||(e[3]=a=>g())},{default:n(()=>[x(c(s(t)("search")),1)]),_:1}),l(v,{onClick:e[4]||(e[4]=a=>j(w.value))},{default:n(()=>[x(c(s(t)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),i("div",Ce,[i("div",ke,[l(N,{modelValue:_.value,"onUpdate:modelValue":e[5]||(e[5]=a=>_.value=a),size:"large",class:"px-[14px]",onChange:R,indeterminate:b.value},null,8,["modelValue","indeterminate"]),l(v,{onClick:B,size:"small"},{default:n(()=>[x(c(s(t)("batchRecycle")),1)]),_:1})]),Q((y(),F(W,{data:o.data,size:"large",ref_key:"goodsListTableRef",ref:S,onSortChange:r.sortChange,onSelectionChange:$},{empty:n(()=>[i("span",null,c(o.loading?"":s(t)("emptyData")),1)]),default:n(()=>[l(u,{type:"selection",width:"55"}),l(u,{prop:"goods_id",label:s(t)("goodsInfo"),"min-width":"300"},{default:n(({row:a})=>[i("div",Ee,[i("div",Te,[i("img",{class:"max-w-[70px] max-h-[70px]",src:s(Z)(a.goods_cover_thumb_small)},null,8,Ve)]),i("div",we,[i("span",{title:a.goods_name,class:"multi-hidden"},c(a.goods_name),9,Pe),i("span",Re,c(a.goods_type_name),1)])])]),_:1},8,["label"]),l(u,{prop:"price",label:s(t)("price"),"min-width":"120",align:"right",sortable:"custom"},{default:n(({row:a})=>[i("div",null,"ï¿¥"+c(a.goodsSku.price),1)]),_:1},8,["label"]),l(u,{prop:"stock",label:s(t)("stock"),"min-width":"120",sortable:"custom"},null,8,["label"]),l(u,{prop:"sale_num",label:s(t)("saleNum"),"min-width":"100",sortable:"custom"},null,8,["label"]),l(u,{prop:"status",label:s(t)("status"),"min-width":"100"},{default:n(({row:a})=>[a.status==1?(y(),E("div",Se,c(s(t)("statusOn")),1)):D("",!0),a.status==0?(y(),E("div",Be,c(s(t)("statusOff")),1)):D("",!0)]),_:1},8,["label"]),l(u,{prop:"create_time",label:s(t)("createTime"),"min-width":"150",sortable:"custom"},{default:n(({row:a})=>[i("div",null,c(a.create_time),1)]),_:1},8,["label"]),l(u,{label:s(t)("operation"),fixed:"right",align:"right","min-width":"120"},{default:n(({row:a})=>[l(v,{type:"primary",link:"",onClick:Ue=>O(a)},{default:n(()=>[x(c(s(t)("recycle")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data","onSortChange"])),[[X,o.loading]]),i("div",ze,[i("div",Ne,[l(N,{modelValue:_.value,"onUpdate:modelValue":e[6]||(e[6]=a=>_.value=a),size:"large",class:"px-[14px]",onChange:R,indeterminate:b.value},null,8,["modelValue","indeterminate"]),l(v,{onClick:B,size:"small"},{default:n(()=>[x(c(s(t)("batchRecycle")),1)]),_:1})]),l(H,{"current-page":o.page,"onUpdate:current-page":e[7]||(e[7]=a=>o.page=a),"page-size":o.limit,"onUpdate:page-size":e[8]||(e[8]=a=>o.limit=a),layout:"total, sizes, prev, pager, next, jumper",total:o.total,onSizeChange:e[9]||(e[9]=a=>g()),onCurrentChange:g},null,8,["current-page","page-size","total"])])])]),_:1})])}}});const la=ye(Fe,[["__scopeId","data-v-a3b8dbb4"]]);export{la as default};
