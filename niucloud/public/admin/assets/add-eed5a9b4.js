import{d as I,f as $,r as y,q as F,N as i,h as G,c as j,a as n,u,t as m,e as l,w as a,i as d,y as _,z as v,W as K,X as W,ay as X,az as Y,cI as A,cK as H,Y as J,_ as M,E as O}from"./index-a2233f8b.js";/* empty css                  *//* empty css                *//* empty css                *//* empty css                       *//* empty css                 *//* empty css                     *//* empty css                  *//* empty css                          *//* empty css               *//* empty css                    *//* empty css                 *//* empty css                       */import"./el-form-item-4ed993c7.js";import{g as Q,a as Z}from"./marketing-04947b9e.js";import ee from"./goods-select-popup-ba8baf79.js";/* empty css                   *//* empty css                   *//* empty css                      *//* empty css                  *//* empty css                  *//* empty css                        */import"./el-tooltip-4ed993c7.js";/* empty css                 *//* empty css                        */import"./goods_default-664bb559.js";import"./goods-b7f9d4bf.js";import"./_plugin-vue_export-helper-c27b6911.js";const le={class:"main-container"},te={class:"detail-head"},ae=n("span",{class:"iconfont iconxiangzuojiantou !text-xs"},null,-1),oe={class:"ml-[1px]"},ie=n("span",{class:"adorn"},"|",-1),ue={class:"right"},de={class:"flex items-center",type:"number",οninput:"value=value.replace(/[^\\d.]/g,'')",style:{"padding-left":"5px"}},re={class:"flex items-center",style:{"padding-left":"5px"}},ne={class:"w-[220px]",style:{"padding-left":"5px"}},se=n("div",{class:"form-tip"},"开启手动领取后，会员可以直接在优惠券列表以及优惠券推广中直接领取",-1),pe={class:"w-[180px]"},me=n("div",{class:"form-tip"},"最多发放100000张",-1),_e={class:"fixed-footer-wrap"},ve={class:"fixed-footer"},We=I({__name:"add",setup(ce){const w=$(),g=y(!1),U=y(null),k=new Date,b=new Date;b.setTime(b.getTime()+3600*1e3*2*360);const e=y({title:"",price:"",type:1,limit:2,receive_type:1,remain_count:1e3,threshold:2,limit_count:1,min_condition_money:1,length:30,goods_ids:[],goods_category_ids:[],receive_type_time:2,valid_type:1,receive_time:[k,b],valid_time:b}),V=y(),P=F(()=>({title:[{required:!0,message:i("titlePlaceholder"),trigger:"blur"}],price:[{required:!0,validator:R,trigger:"blur"}],remain_count:[{required:!0,validator:E,trigger:"blur"}],limit_count:[{required:!0,validator:T,trigger:"blur"}]})),E=(c,t,s)=>{e.value.remain_count!=""&&e.value.remain_count>1e5&&s(new Error(i("remainCountPlaceholder"))),s()},R=(c,t,s)=>{e.value.price!=""&&e.value.price<.01&&s(new Error(i("pricePlaceholder"))),s()},T=(c,t,s)=>{e.value.limit_count!=""&&e.value.limit_count<1&&s(new Error(i("userLimitCountPlaceholder"))),s()},S={multiple:!0},h=y([]),D=()=>{Q({}).then(c=>{h.value=c.data.goods_category_tree})},q=async c=>{g.value||!c||await c.validate(async t=>{if(t){g.value=!0;const s=e.value;Z(s).then(p=>{g.value=!1,history.back()}).catch(p=>{g.value=!1})}})},L=()=>{history.back()};return(c,t)=>{const s=K,r=W,p=X,f=Y,N=A,x=H,B=J,z=M,C=O;return G(),j("div",le,[n("div",te,[n("div",{class:"left",onClick:t[0]||(t[0]=o=>u(w).push("/shop/marketing/coupon/list"))},[ae,n("span",oe,m(u(i)("returnToPreviousPage")),1)]),ie,n("span",ue,m(u(i)("addCoupon")),1)]),l(z,{class:"box-card !border-none",shadow:"never"},{default:a(()=>[l(B,{model:e.value,"label-width":"120px",ref_key:"formRef",ref:V,rules:u(P),class:"page-form"},{default:a(()=>[l(r,{label:u(i)("title"),prop:"title"},{default:a(()=>[l(s,{modelValue:e.value.title,"onUpdate:modelValue":t[1]||(t[1]=o=>e.value.title=o),clearable:"",placeholder:u(i)("titlePlaceholder"),class:"input-width",maxlength:20},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(r,{label:u(i)("price"),prop:"price"},{default:a(()=>[l(s,{type:"number",οninput:"value=value.replace(/[^\\d.]/g,'')",modelValue:e.value.price,"onUpdate:modelValue":t[2]||(t[2]=o=>e.value.price=o),clearable:"",placeholder:u(i)("pricePlaceholder"),class:"input-width",maxlength:"60"},{append:a(()=>[d("元")]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),l(r,{label:u(i)("type"),prop:"type"},{default:a(()=>[l(f,{modelValue:e.value.type,"onUpdate:modelValue":t[3]||(t[3]=o=>e.value.type=o)},{default:a(()=>[l(p,{label:1},{default:a(()=>[d("通用券")]),_:1}),l(p,{label:2,onClick:D},{default:a(()=>[d("品类券")]),_:1}),l(p,{label:3},{default:a(()=>[d("商品券")]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),_(l(r,null,{default:a(()=>[n("div",null,[l(N,{modelValue:e.value.goods_category_ids,"onUpdate:modelValue":t[4]||(t[4]=o=>e.value.goods_category_ids=o),options:h.value,props:S,placeholder:"请选择商品分类","collapse-tags":"","collapse-tags-tooltip":"",clearable:""},null,8,["modelValue","options"])])]),_:1},512),[[v,e.value.type==2]]),_(l(r,null,{default:a(()=>[n("div",null,[l(r,null,{default:a(()=>[l(ee,{ref_key:"goodsSelectPopupRef",ref:U,modelValue:e.value.goods_ids,"onUpdate:modelValue":t[5]||(t[5]=o=>e.value.goods_ids=o),min:1,max:99},null,8,["modelValue"])]),_:1})])]),_:1},512),[[v,e.value.type==3]]),l(r,{label:u(i)("threshold")},{default:a(()=>[l(f,{modelValue:e.value.threshold,"onUpdate:modelValue":t[6]||(t[6]=o=>e.value.threshold=o)},{default:a(()=>[l(p,{label:1},{default:a(()=>[d(m(u(i)("reduction")),1)]),_:1}),l(p,{label:2},{default:a(()=>[d(m(u(i)("noThreshold")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),_(l(r,null,{default:a(()=>[d(" 最低满 "),n("div",de,[l(s,{type:"number",modelValue:e.value.min_condition_money,"onUpdate:modelValue":t[7]||(t[7]=o=>e.value.min_condition_money=o),clearable:"",class:"!w-[100px]"},null,8,["modelValue"])]),d(" 元可用 ")]),_:1},512),[[v,e.value.threshold==1]]),l(r,{label:u(i)("validType")},{default:a(()=>[l(f,{modelValue:e.value.valid_type,"onUpdate:modelValue":t[8]||(t[8]=o=>e.value.valid_type=o)},{default:a(()=>[l(p,{label:1},{default:a(()=>[d(m(u(i)("days")),1)]),_:1}),l(p,{label:2},{default:a(()=>[d(m(u(i)("times")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),_(l(r,null,{default:a(()=>[d(" 领劵后立即生效，有效期 "),n("div",re,[l(s,{type:"number",modelValue:e.value.length,"onUpdate:modelValue":t[9]||(t[9]=o=>e.value.length=o),clearable:"",class:"!w-[100px]"},null,8,["modelValue"]),d(" 天 ")])]),_:1},512),[[v,e.value.valid_type==1]]),_(l(r,{prop:"valid_time"},{default:a(()=>[d(" 领劵后立即生效，使用时间截止至 "),n("div",ne,[l(x,{modelValue:e.value.valid_time,"onUpdate:modelValue":t[10]||(t[10]=o=>e.value.valid_time=o),type:"datetime"},null,8,["modelValue"])])]),_:1},512),[[v,e.value.valid_type==2]]),l(r,{label:u(i)("receiveType")},{default:a(()=>[n("div",null,[l(f,{modelValue:e.value.receive_type,"onUpdate:modelValue":t[11]||(t[11]=o=>e.value.receive_type=o)},{default:a(()=>[l(p,{label:1},{default:a(()=>[d(m(u(i)("user")),1)]),_:1}),l(p,{label:2},{default:a(()=>[d(m(u(i)("grant")),1)]),_:1})]),_:1},8,["modelValue"])]),se]),_:1},8,["label"]),_(l(r,{label:u(i)("receiveTime")},{default:a(()=>[l(f,{modelValue:e.value.receive_type_time,"onUpdate:modelValue":t[12]||(t[12]=o=>e.value.receive_type_time=o)},{default:a(()=>[l(p,{label:1},{default:a(()=>[d(m(u(i)("limitedTime")),1)]),_:1}),l(p,{label:2},{default:a(()=>[d(m(u(i)("unlimitedTime")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),[[v,e.value.receive_type==1]]),_(l(r,{prop:"receive_time"},{default:a(()=>[n("div",pe,[l(x,{modelValue:e.value.receive_time,"onUpdate:modelValue":t[13]||(t[13]=o=>e.value.receive_time=o),type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])])]),_:1},512),[[v,e.value.receive_type_time==1&&e.value.receive_type==1]]),_(l(r,{label:u(i)("receiveNumber")},{default:a(()=>[l(f,{modelValue:e.value.limit,"onUpdate:modelValue":t[14]||(t[14]=o=>e.value.limit=o)},{default:a(()=>[l(p,{label:1},{default:a(()=>[d(m(u(i)("limit")),1)]),_:1}),l(p,{label:2},{default:a(()=>[d(m(u(i)("unlimited")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),[[v,e.value.receive_type==1]]),_(l(r,{prop:"remain_count"},{default:a(()=>[n("div",null,[l(s,{type:"number",onkeypress:"return( /[\\d]/.test(String.fromCharCode(event.keyCode) ) )",modelValue:e.value.remain_count,"onUpdate:modelValue":t[15]||(t[15]=o=>e.value.remain_count=o),clearable:"",placeholder:u(i)("remainCountPlaceholder"),class:"input-width",min:1,max:1e5,controls:!1},{append:a(()=>[d("张")]),_:1},8,["modelValue","placeholder"])]),me]),_:1},512),[[v,e.value.limit==1&&e.value.receive_type==1]]),_(l(r,{label:u(i)("userLimitCount"),prop:"limit_count"},{default:a(()=>[l(s,{type:"number",onkeypress:"return( /[\\d]/.test(String.fromCharCode(event.keyCode) ) )",modelValue:e.value.limit_count,"onUpdate:modelValue":t[16]||(t[16]=o=>e.value.limit_count=o),clearable:"",placeholder:u(i)("userLimitCountPlaceholder"),class:"input-width",min:1,max:1e5},{append:a(()=>[d("张")]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),[[v,e.value.receive_type==1]])]),_:1},8,["model","rules"])]),_:1}),n("div",_e,[n("div",ve,[l(C,{type:"primary",onClick:t[17]||(t[17]=o=>q(V.value))},{default:a(()=>[d(m(u(i)("save")),1)]),_:1}),l(C,{onClick:t[18]||(t[18]=o=>L())},{default:a(()=>[d(m(u(i)("cancel")),1)]),_:1})])])])}}});export{We as default};
