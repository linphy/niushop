import{d as pe,v as ue,f as me,l as E,M as J,k as t,r as g,h as p,c as v,e as o,w as n,a as w,t as d,u as a,i as m,F as T,O as N,m as b,J as ce,B as U,S as fe,E as _e,D as ye,G as he,_ as ge,ac as ve,H as be,K as we,$ as Ve,a0 as ke,a1 as Pe,V as Ce,a7 as De,a8 as xe,L as Ee}from"./index-ad4e42d5.js";/* empty css                   */import Te from"./index-3cd61bba.js";/* empty css                    *//* empty css                  *//* empty css                   *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                        *//* empty css                *//* empty css                     *//* empty css                  */import{h as Ue,j as $e,k as Fe,s as Se,l as Ne,m as Re}from"./diy-54696cdb.js";/* empty css                        */import"./index.vue_vue_type_style_index_0_lang-32b12c72.js";import"./attachment-621e6518.js";import"./index.vue_vue_type_script_setup_true_lang-4946e851.js";/* empty css                 *//* empty css               *//* empty css                    *//* empty css                         */import"./index.vue_vue_type_script_setup_true_lang-9334503d.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_lang-39123e55.js";import"./sys-747f9e8e.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./sortable.esm-be94e56d.js";const Be={class:"main-container"},Ae={class:"flex justify-between items-center"},Ie={class:"text-page-title"},ze={key:0},qe={key:0,class:"text-primary"},Le={key:1},je={class:"mt-[16px] flex justify-end"},Ge={class:"dialog-footer"},Oe={class:"dialog-footer"},xl=pe({__name:"list",setup(Je){const Y=ue(),$=me(),M=Y.meta.title,P=E({}),y=E({title:"",type:""}),H=J(()=>({title:[{required:!0,message:t("titlePlaceholder"),trigger:"blur"}],type:[{required:!0,message:t("pageTypePlaceholder"),trigger:"blur"}]})),R=g(),C=g(!1),K=async r=>{r&&await r.validate(async e=>{if(e){const s={type:y.type,title:y.title},V=$.resolve({path:"/decorate/edit",query:s});window.open(V.href),C.value=!1,y.title="",y.type=""}})},B=(r="")=>{$e({mode:"",addon:r}).then(e=>{for(let s in P)delete P[s];for(const s in e.data)P[s]=e.data[s]})};B();const A=E({});Ue().then(r=>{if(r.data)for(const e in r.data)A[e]=r.data[e]});const Q=r=>{i.searchParam.type="",B(r)},i=E({page:1,limit:10,total:0,loading:!0,data:[],searchParam:{title:"",type:"",mode:"",addon_name:""}}),I=g(),h=(r=1)=>{i.loading=!0,i.page=r,Fe({page:i.page,limit:i.limit,...i.searchParam}).then(e=>{i.loading=!1,i.data=e.data.data,i.total=e.data.total}).catch(()=>{i.loading=!1})};h();const W=r=>{const e=$.resolve({path:"/decorate/edit",query:{id:r.id}});window.open(e.href)},X=r=>{Se({id:r}).then(()=>{h()})},Z=r=>{fe.confirm(t("diyPageDeleteTips"),t("warning"),{confirmButtonText:t("confirm"),cancelButtonText:t("cancel"),type:"warning"}).then(()=>{Ne(r).then(()=>{h()}).catch(()=>{})})},ee=r=>{const e=$.resolve({path:"/preview/wap",query:{page:r.type_page+"?id="+r.id}});window.open(e.href)},c=g("wechat"),z=g(""),q=g(0),f=E({wechat:{title:"",desc:"",url:""},weapp:{title:"",url:""}}),D=g(!1),le=J(()=>({})),L=g(),te=async r=>{q.value=r.id,z.value=r.title;const e=r.share?JSON.parse(r.share):{wechat:{title:"",desc:"",url:""},weapp:{title:"",url:""}};e&&(f.wechat=e.wechat,f.weapp=e.weapp),D.value=!0},ae=async r=>{r&&await r.validate(async e=>{e&&Re({id:q.value,share:JSON.stringify(f)}).then(()=>{h(),D.value=!1}).catch(()=>{})})},oe=r=>{r&&(r.resetFields(),h())};return(r,e)=>{const s=_e,V=ye,_=he,x=ge,F=ve,S=be,j=we,k=Ve,ne=ke,re=Pe,G=Ce,O=De,ie=xe,se=Te,de=Ee;return p(),v("div",Be,[o(j,{class:"box-card !border-none",shadow:"never"},{default:n(()=>[w("div",Ae,[w("span",Ie,d(a(M)),1),o(s,{type:"primary",class:"w-[100px]",onClick:e[0]||(e[0]=l=>C.value=!0)},{default:n(()=>[m(d(a(t)("addDiyPage")),1)]),_:1})]),o(j,{class:"box-card !border-none my-[10px] table-search-wrap",shadow:"never"},{default:n(()=>[o(S,{inline:!0,model:i.searchParam,ref_key:"searchFormDiyPageRef",ref:I},{default:n(()=>[o(_,{label:a(t)("title"),prop:"title"},{default:n(()=>[o(V,{modelValue:i.searchParam.title,"onUpdate:modelValue":e[1]||(e[1]=l=>i.searchParam.title=l),placeholder:a(t)("titlePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(_,{label:a(t)("forAddon"),prop:"addon_name"},{default:n(()=>[o(F,{modelValue:i.searchParam.addon_name,"onUpdate:modelValue":e[2]||(e[2]=l=>i.searchParam.addon_name=l),placeholder:a(t)("forAddonPlaceholder"),onChange:Q},{default:n(()=>[o(x,{label:a(t)("all"),value:""},null,8,["label"]),(p(!0),v(T,null,N(A,(l,u)=>(p(),b(x,{label:l.title,value:u,key:u},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(_,{label:a(t)("typeName"),prop:"type"},{default:n(()=>[o(F,{modelValue:i.searchParam.type,"onUpdate:modelValue":e[3]||(e[3]=l=>i.searchParam.type=l),placeholder:a(t)("pageTypePlaceholder")},{default:n(()=>[o(x,{label:a(t)("all"),value:""},null,8,["label"]),(p(!0),v(T,null,N(P,(l,u)=>(p(),b(x,{label:l.title,value:u,key:u},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(_,null,{default:n(()=>[o(s,{type:"primary",onClick:e[4]||(e[4]=l=>h())},{default:n(()=>[m(d(a(t)("search")),1)]),_:1}),o(s,{onClick:e[5]||(e[5]=l=>oe(I.value))},{default:n(()=>[m(d(a(t)("reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),ce((p(),b(ne,{data:i.data,size:"large"},{empty:n(()=>[w("span",null,d(i.loading?"":a(t)("emptyData")),1)]),default:n(()=>[o(k,{prop:"page_title",label:a(t)("title"),"min-width":"120"},null,8,["label"]),o(k,{prop:"addon_name",label:a(t)("forAddon"),"min-width":"80"},null,8,["label"]),o(k,{prop:"type_name",label:a(t)("typeName"),"min-width":"80"},null,8,["label"]),o(k,{label:a(t)("status"),"min-width":"80"},{default:n(({row:l})=>[l.type=="DIY_PAGE"?(p(),v("span",ze,"-")):(p(),v(T,{key:1},[l.is_default==1?(p(),v("span",qe,d(a(t)("isUse")),1)):(p(),v("span",Le,d(a(t)("unused")),1))],64))]),_:1},8,["label"]),o(k,{prop:"update_time",label:a(t)("updateTime"),"min-width":"120"},null,8,["label"]),o(k,{label:a(t)("operation"),fixed:"right",align:"right","min-width":"160"},{default:n(({row:l})=>[o(s,{type:"primary",link:"",onClick:u=>ee(l)},{default:n(()=>[m(d(a(t)("preview")),1)]),_:2},1032,["onClick"]),l.is_default==0?(p(),b(s,{key:0,type:"primary",link:"",onClick:u=>X(l.id)},{default:n(()=>[m(d(a(t)("use")),1)]),_:2},1032,["onClick"])):U("",!0),l.type=="DIY_PAGE"?(p(),b(s,{key:1,type:"primary",link:"",onClick:u=>te(l)},{default:n(()=>[m(d(a(t)("shareSet")),1)]),_:2},1032,["onClick"])):U("",!0),o(s,{type:"primary",link:"",onClick:u=>W(l)},{default:n(()=>[m(d(a(t)("edit")),1)]),_:2},1032,["onClick"]),l.is_default==0||l.type=="DIY_PAGE"?(p(),b(s,{key:2,type:"primary",link:"",onClick:u=>Z(l.id)},{default:n(()=>[m(d(a(t)("delete")),1)]),_:2},1032,["onClick"])):U("",!0)]),_:1},8,["label"])]),_:1},8,["data"])),[[de,i.loading]]),w("div",je,[o(re,{"current-page":i.page,"onUpdate:current-page":e[6]||(e[6]=l=>i.page=l),"page-size":i.limit,"onUpdate:page-size":e[7]||(e[7]=l=>i.limit=l),layout:"total, sizes, prev, pager, next, jumper",total:i.total,onSizeChange:e[8]||(e[8]=l=>h()),onCurrentChange:h},null,8,["current-page","page-size","total"])])]),_:1}),o(G,{modelValue:C.value,"onUpdate:modelValue":e[13]||(e[13]=l=>C.value=l),title:a(t)("addPageTips"),width:"25%"},{footer:n(()=>[w("span",Ge,[o(s,{onClick:e[11]||(e[11]=l=>C.value=!1)},{default:n(()=>[m(d(a(t)("cancel")),1)]),_:1}),o(s,{type:"primary",onClick:e[12]||(e[12]=l=>K(R.value))},{default:n(()=>[m(d(a(t)("confirm")),1)]),_:1})])]),default:n(()=>[o(S,{model:y,"label-width":"90px",ref_key:"formRef",ref:R,rules:a(H)},{default:n(()=>[o(_,{label:a(t)("title"),prop:"title"},{default:n(()=>[o(V,{modelValue:y.title,"onUpdate:modelValue":e[9]||(e[9]=l=>y.title=l),placeholder:a(t)("titlePlaceholder"),clearable:"",maxlength:"12","show-word-limit":"",class:"w-full"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(_,{label:a(t)("typeName"),prop:"type"},{default:n(()=>[o(F,{modelValue:y.type,"onUpdate:modelValue":e[10]||(e[10]=l=>y.type=l),placeholder:a(t)("pageTypePlaceholder"),class:"w-full"},{default:n(()=>[(p(!0),v(T,null,N(P,(l,u)=>(p(),b(x,{label:l.title,value:u,key:u},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),o(G,{modelValue:D.value,"onUpdate:modelValue":e[20]||(e[20]=l=>D.value=l),title:a(t)("shareSet"),width:"30%"},{footer:n(()=>[w("span",Oe,[o(s,{onClick:e[18]||(e[18]=l=>D.value=!1)},{default:n(()=>[m(d(a(t)("cancel")),1)]),_:1}),o(s,{type:"primary",onClick:e[19]||(e[19]=l=>ae(L.value))},{default:n(()=>[m(d(a(t)("confirm")),1)]),_:1})])]),default:n(()=>[o(ie,{modelValue:c.value,"onUpdate:modelValue":e[14]||(e[14]=l=>c.value=l)},{default:n(()=>[o(O,{label:a(t)("wechat"),name:"wechat"},null,8,["label"]),o(O,{label:a(t)("weapp"),name:"weapp"},null,8,["label"])]),_:1},8,["modelValue"]),o(S,{model:f[c.value],"label-width":"90px",ref_key:"shareFormRef",ref:L,rules:a(le)},{default:n(()=>[o(_,{label:a(t)("sharePage")},{default:n(()=>[w("span",null,d(z.value),1)]),_:1},8,["label"]),o(_,{label:a(t)("shareTitle"),prop:"title"},{default:n(()=>[o(V,{modelValue:f[c.value].title,"onUpdate:modelValue":e[15]||(e[15]=l=>f[c.value].title=l),placeholder:a(t)("shareTitlePlaceholder"),clearable:"",maxlength:"30","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),c.value=="wechat"?(p(),b(_,{key:0,label:a(t)("shareDesc"),prop:"desc"},{default:n(()=>[o(V,{modelValue:f[c.value].desc,"onUpdate:modelValue":e[16]||(e[16]=l=>f[c.value].desc=l),placeholder:a(t)("shareDescPlaceholder"),type:"textarea",rows:"4",clearable:"",maxlength:"100","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):U("",!0),o(_,{label:a(t)("shareImageUrl"),prop:"url"},{default:n(()=>[o(se,{modelValue:f[c.value].url,"onUpdate:modelValue":e[17]||(e[17]=l=>f[c.value].url=l),limit:1},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{xl as default};
